#include <string>
#include <sstream>
char histname[100];
Color_t color171 = kGreen;
Color_t color181 = kRed;
Color_t color188 = kBlue;
int data = 0;
int mc = 1;

void setformatTH1F(TH1F * hist, Color_t color, int type) {  
	if(type == 0 )	{ hist->SetMarkerStyle(20); }
	if(type == 1 ) 	{ hist->SetMarkerStyle(25); }
	hist->GetYaxis()->SetTitleOffset(1.3);
	hist->SetMarkerSize(0.8);
	hist->SetMarkerColor(color);
	hist->SetLineColor(color);
	hist->GetXaxis()->SetTitleSize(0.04);
	hist->GetYaxis()->SetTitleSize(0.04);	
}

void setformatTH1I(TH1I * hist, Color_t color, int type) {  
	if(type == 0 )	{ hist->SetMarkerStyle(20); } //data format
	if(type == 1 ) 	{ hist->SetMarkerStyle(25); } //mc format
	hist->GetYaxis()->SetTitleOffset(1.3);
	hist->SetMarkerSize(0.8);
	hist->SetMarkerColor(color);
	hist->SetLineColor(color);	
	hist->GetXaxis()->SetTitleSize(0.04);
	hist->GetYaxis()->SetTitleSize(0.04);
}

void normalizeMC(TH1F * histdata, TH1F * histmc) {
	double mcentries = histmc->GetEntries();
	double dataentries = histdata->GetEntries();
	double norm = dataentries/mcentries;
	histmc->Scale(norm);  
}

void plots_kinematics() {
	char version[100] = "june2020";
	char version201808[100] = "2018-08_ANAver02_june2020";
	char version201801[100] = "2018-01_ANAver03_june2020";
	char version201701[100] = "2017-01_ANAver20_june2020";
	TFile * data201701 = TFile::Open("~/2020xsec_workfest/kpkpxim__B4_M23_allbatches_2017-01_june13.root");
	TFile * data201801 = TFile::Open("~/2020xsec_workfest/kpkpxim__B4_M23_allbatches_2018-01_ANAver03_543runs_june12.root");
	TFile * data201808 = TFile::Open("~/2020xsec_workfest/kpkpxim__B4_M23_allbatches_2018-08_ANAver02_449runs_june12.root");
	TFile * mc201701 = TFile::Open("~/2020xsec_workfest/kpkpxim__B4_M23_genr8_2017_01_ANAver20_june13.root");
	TFile * mc201801 = TFile::Open("~/2020xsec_workfest/kpkpxim__B4_M23_genr8_2018_01_ANAver03_june12.root");
	TFile * mc201808 = TFile::Open("~/2020xsec_workfest/kpkpxim__B4_M23_genr8_2018_08_ANAver02_june12.root");
	TFile * thrown201701 = TFile::Open("~/2020xsec_workfest/thrown_2017-01_ANAver20_june13.root");
	TFile * thrown201801 = TFile::Open("~/2020xsec_workfest/thrown_2018-01_ANAver03_june13.root");
	TFile * thrown201808 = TFile::Open("~/2020xsec_workfest/thrown_2018-08_ANAver02_june13.root");
	
	TFile *outputfile = new TFile("output_plots_kinematics.root","RECREATE");
	
	gStyle->SetOptStat(0000);


	char beamacc17name[100];
	TCanvas *ccbeamacc17 = new TCanvas("ccbeamacc17", "ccbeamacc17", 800, 600);
	TH1I * beamacc17 = (TH1I*)data201701->Get("BeamBunch_Xi_acc");
	TH1I * beamacc17_wacc = (TH1I*)data201701->Get("BeamBunch_Xi_wacc");
	setformatTH1I(beamacc17,color171,data);
	beamacc17->SetTitle("Beam #gamma");
	beamacc17->GetXaxis()->SetTitle("#Delta t_{Beam-RF} (ns)");
	beamacc17->GetYaxis()->SetRangeUser(0,1000);
	beamacc17->GetXaxis()->SetTitleSize(0.04);
	beamacc17->Draw("pe");
	setformatTH1I(beamacc17_wacc,color171,data);
	//beamacc17_wacc->Draw("pe,same");
	auto legend_beambunch = new TLegend(0.80,0.85,0.98,0.93);
	legend_beambunch->AddEntry(beamacc17,"Not weighted","lep");
	legend_beambunch->AddEntry(beamacc17_wacc,"Weighted","lep");
	//legend_beambunch->Draw();
	sprintf(beamacc17name, "beambunches_%s_data.png",version201701);
	ccbeamacc17->Print(beamacc17name);

	char XiKlowpPhiThetaGJ17name[100];
	TCanvas *ccXiKlowpPhiThetaGJ17 = new TCanvas("ccXiKlowpPhiThetaGJ17", "ccXiKlowpPhiThetaGJ17", 800, 600);
	TH2I * XiKlowpPhiThetaGJ17 = (TH2I*)data201701->Get("Klowp_phiTheta_YstarGJ_KinFit");
	TH2I * XiKlowpPhiThetaGJ17_wacc = (TH2I*)data201701->Get("Klowp_phiTheta_YstarGJ_KinFit_wacc");
	TH2I * XiKlowpPhiThetaGJ17_waccsub = (TH2I *) XiKlowpPhiThetaGJ17->Clone("XiKlowpPhiThetaGJ17_waccsub");
	XiKlowpPhiThetaGJ17_waccsub->Add(XiKlowpPhiThetaGJ17_wacc,-0.5);
	XiKlowpPhiThetaGJ17_waccsub->SetTitle("K+_{decay}");
	XiKlowpPhiThetaGJ17_waccsub->GetXaxis()->SetTitle("#theta_{GJ} (deg)");
	XiKlowpPhiThetaGJ17_waccsub->GetYaxis()->SetTitle("#phi_{GJ} (deg)");
	XiKlowpPhiThetaGJ17_waccsub->RebinY(4);
	XiKlowpPhiThetaGJ17_waccsub->Draw("colz");
	sprintf(XiKlowpPhiThetaGJ17name, "Xi_Klowp_phitheta_kinfit_GJframe_%s_data.png",version201701);
	ccXiKlowpPhiThetaGJ17->Print(XiKlowpPhiThetaGJ17name);

	char XiKlowpPhiThetaGJ17MCname[100];
	TCanvas *ccXiKlowpPhiThetaGJ17MC = new TCanvas("ccXiKlowpPhiThetaGJ17MC", "ccXiKlowpPhiThetaGJ17MC", 800, 600);
	TH2I * XiKlowpPhiThetaGJ17MC = (TH2I*)mc201701->Get("Klowp_phiTheta_YstarGJ_KinFit");
	TH2I * XiKlowpPhiThetaGJ17MC_wacc = (TH2I*)mc201701->Get("Klowp_phiTheta_YstarGJ_KinFit_wacc");
	TH2I * XiKlowpPhiThetaGJ17MC_waccsub = (TH2I *) XiKlowpPhiThetaGJ17MC->Clone("XiKlowpPhiThetaGJ17MC_waccsub");
	XiKlowpPhiThetaGJ17MC_waccsub->Add(XiKlowpPhiThetaGJ17MC_wacc,-0.5);
	XiKlowpPhiThetaGJ17MC_waccsub->SetTitle("K+_{decay}");
	XiKlowpPhiThetaGJ17MC_waccsub->GetXaxis()->SetTitle("#theta_{GJ} (deg)");
	XiKlowpPhiThetaGJ17MC_waccsub->GetYaxis()->SetTitle("#phi_{GJ} (deg)");
	XiKlowpPhiThetaGJ17MC_waccsub->RebinY(4);
	XiKlowpPhiThetaGJ17MC_waccsub->Draw("colz");
	sprintf(XiKlowpPhiThetaGJ17MCname, "Xi_Klowp_phitheta_kinfit_GJframe_%s_MC.png",version201701);
	ccXiKlowpPhiThetaGJ17MC->Print(XiKlowpPhiThetaGJ17MCname);

	char XiKlowpPhiThetaGJ17MCThrownname[100];
	TCanvas *ccXiKlowpPhiThetaGJ17MCThrown = new TCanvas("ccXiKlowpPhiThetaGJ17MCThrown", "ccXiKlowpPhiThetaGJ17MCThrown", 800, 600);
	TH2I * XiKlowpPhiThetaGJ17MCThrown = (TH2I*)thrown201701->Get("Klowp_phiTheta_YstarGJ");
	XiKlowpPhiThetaGJ17MCThrown->SetTitle("K+_{decay}");
	XiKlowpPhiThetaGJ17MCThrown->GetXaxis()->SetTitle("#theta_{GJ} (deg)");
	XiKlowpPhiThetaGJ17MCThrown->GetYaxis()->SetTitle("#phi_{GJ} (deg)");
	XiKlowpPhiThetaGJ17MCThrown->GetZaxis()->SetRangeUser(0,5000);
	XiKlowpPhiThetaGJ17MCThrown->RebinY(4);
	XiKlowpPhiThetaGJ17MCThrown->Draw("colz");
	sprintf(XiKlowpPhiThetaGJ17MCThrownname, "Xi_Klowp_phitheta_kinfit_GJframe_%s_thrown.png",version201701);
	ccXiKlowpPhiThetaGJ17MCThrown->Print(XiKlowpPhiThetaGJ17MCThrownname);

	char XiKlowpPhiThetaReconThrownGJ17MCname[100];
	TCanvas *ccXiKlowpPhiThetaReconThrownGJ17MC = new TCanvas("ccXiKlowpPhiThetaReconThrownGJ17MC", "ccXiKlowpPhiThetaReconThrownGJ17MC", 800, 600);
	TH2I * XiKlowpPhiThetaReconThrownGJ17MC = (TH2I*)mc201701->Get("Klowp_phiTheta_YstarGJ_reconthrown");
	TH2I * XiKlowpPhiThetaReconThrownGJ17MC_wacc = (TH2I*)mc201701->Get("Klowp_phiTheta_YstarGJ_reconthrown_wacc");
	TH2I * XiKlowpPhiThetaReconThrownGJ17MC_waccsub = (TH2I *) XiKlowpPhiThetaReconThrownGJ17MC->Clone("XiKlowpPhiThetaReconThrownGJ17MC_waccsub");
	XiKlowpPhiThetaReconThrownGJ17MC_waccsub->Add(XiKlowpPhiThetaReconThrownGJ17MC_wacc,-0.5);
	XiKlowpPhiThetaReconThrownGJ17MC_waccsub->SetTitle("K+_{decay}");
	XiKlowpPhiThetaReconThrownGJ17MC_waccsub->GetXaxis()->SetTitle("#theta^{thrown}_{GJ} (deg)");
	XiKlowpPhiThetaReconThrownGJ17MC_waccsub->GetYaxis()->SetTitle("#phi^{thrown}_{GJ} (deg)");
	XiKlowpPhiThetaReconThrownGJ17MC_waccsub->RebinY(4);
	XiKlowpPhiThetaReconThrownGJ17MC_waccsub->Draw("colz");
	sprintf(XiKlowpPhiThetaReconThrownGJ17MCname, "Xi_Klowp_phitheta_GJframe_reconthrown_%s_MC.png",version201701);
	ccXiKlowpPhiThetaReconThrownGJ17MC->Print(XiKlowpPhiThetaReconThrownGJ17MCname);

	char XiKlowpdThetaReconThrownGJ17MCname[100];
	TCanvas *ccXiKlowpdThetaReconThrownGJ17MC = new TCanvas("ccXiKlowpdThetaReconThrownGJ17MC", "ccXiKlowpdThetaReconThrownGJ17MC", 800, 600);
	TH1I * XiKlowpdThetaReconThrownGJ17MC = (TH1I*)mc201701->Get("Klowp_dtheta_reconthrown");
	TH1I * XiKlowpdThetaReconThrownGJ17MC_wacc = (TH1I*)mc201701->Get("Klowp_dtheta_reconthrown_wacc");
	TH1I * XiKlowpdThetaReconThrownGJ17MC_waccsub = (TH1I *) XiKlowpdThetaReconThrownGJ17MC->Clone("XiKlowpdThetaReconThrownGJ17MC_waccsub");
	XiKlowpdThetaReconThrownGJ17MC_waccsub->Add(XiKlowpdThetaReconThrownGJ17MC_wacc,-0.5);
	XiKlowpdThetaReconThrownGJ17MC_waccsub->SetTitle("K+_{decay}");
	XiKlowpdThetaReconThrownGJ17MC_waccsub->GetXaxis()->SetTitle("#theta^{thrown}_{GJ} - #theta^{recon}_{GJ} (deg)");
	XiKlowpdThetaReconThrownGJ17MC_waccsub->GetYaxis()->SetTitle("Combos");
	setformatTH1I(XiKlowpdThetaReconThrownGJ17MC_waccsub,color171,mc);
	XiKlowpdThetaReconThrownGJ17MC_waccsub->Draw("pe");
	sprintf(XiKlowpdThetaReconThrownGJ17MCname, "Xi_Klowp_dtheta_GJframe_reconthrown_%s_MC.png",version201701);
	ccXiKlowpdThetaReconThrownGJ17MC->Print(XiKlowpdThetaReconThrownGJ17MCname);

	char XiKlowpdPhiThetaReconThrown150GJ17MCname[100];
	TCanvas *ccXiKlowpdPhiThetaReconThrown150GJ17MC = new TCanvas("ccXiKlowpdPhiThetaReconThrown150GJ17MC", "ccXiKlowpdPhiThetaReconThrown150GJ17MC", 800, 600);
	TH2I * XiKlowpdPhiThetaReconThrown150GJ17MC = (TH2I*)mc201701->Get("Klowp_phiTheta_YstarGJ_thrown150to180");
	TH2I * XiKlowpdPhiThetaReconThrown150GJ17MC_wacc = (TH2I*)mc201701->Get("Klowp_phiTheta_YstarGJ_thrown150to180_wacc");
	TH2I * XiKlowpdPhiThetaReconThrown150GJ17MC_waccsub = (TH2I *) XiKlowpdPhiThetaReconThrown150GJ17MC->Clone("XiKlowpdPhiThetaReconThrown150GJ17MC_waccsub");
	XiKlowpdPhiThetaReconThrown150GJ17MC_waccsub->Add(XiKlowpdPhiThetaReconThrown150GJ17MC_wacc,-0.5);
	XiKlowpdPhiThetaReconThrown150GJ17MC_waccsub->SetTitle("K+_{decay} for #theta^{thrown}_{GJ} > 150deg");
	XiKlowpdPhiThetaReconThrown150GJ17MC_waccsub->GetXaxis()->SetTitle("#theta^{recon}_{GJ} (deg)");
	XiKlowpdPhiThetaReconThrown150GJ17MC_waccsub->GetYaxis()->SetTitle("#phi^{recon}_{GJ} (deg)");
	XiKlowpdPhiThetaReconThrown150GJ17MC_waccsub->RebinY(4);
	XiKlowpdPhiThetaReconThrown150GJ17MC_waccsub->Draw("colz");
	sprintf(XiKlowpdPhiThetaReconThrown150GJ17MCname, "Xi_Klowp_phitheta_GJframe_reconthrown150_%s_MC.png",version201701);
	ccXiKlowpdPhiThetaReconThrown150GJ17MC->Print(XiKlowpdPhiThetaReconThrown150GJ17MCname);


	char XiallKPhiTheta17name[100];
	TCanvas *ccXiallKPhiTheta17 = new TCanvas("ccXiallKPhiTheta17", "ccXiallKPhiTheta17", 800, 600);
	TH2I * XiallKPhiTheta17 = (TH2I*)data201701->Get("allK_phiTheta_CM_KinFit");
	TH2I * XiallKPhiTheta17_wacc = (TH2I*)data201701->Get("allK_phiTheta_CM_KinFit_wacc");
	TH2I * XiallKPhiTheta17_waccsub = (TH2I *) XiallKPhiTheta17->Clone("allK_phiTheta_CM_KinFit_waccsub");
	XiallKPhiTheta17_waccsub->Add(XiallKPhiTheta17_wacc,-0.5);
	XiallKPhiTheta17_waccsub->SetTitle("K+");
	XiallKPhiTheta17_waccsub->GetXaxis()->SetTitle("#theta_{CM} (deg)");
	XiallKPhiTheta17_waccsub->GetYaxis()->SetTitle("#phi_{CM} (deg)");
	XiallKPhiTheta17_waccsub->RebinX(2);
	XiallKPhiTheta17_waccsub->RebinY(4);
	XiallKPhiTheta17_waccsub->Draw("colz");
	sprintf(XiallKPhiTheta17name, "Xi_allK_phitheta_kinfit_CMframe_%s_data.png",version201701);
	ccXiallKPhiTheta17->Print(XiallKPhiTheta17name);

	char XiKhighpPhiTheta17name[100];
	TCanvas *ccXiKhighpPhiTheta17 = new TCanvas("ccXiKhighpPhiTheta17", "ccXiKhighpPhiTheta17", 800, 600);
	TH2I * XiKhighpPhiTheta17 = (TH2I*)data201701->Get("Khighp_phiTheta_CM_KinFit");
	TH2I * XiKhighpPhiTheta17_wacc = (TH2I*)data201701->Get("Khighp_phiTheta_CM_KinFit_wacc");
	TH2I * XiKhighpPhiTheta17_waccsub = (TH2I *) XiKhighpPhiTheta17->Clone("Khighp_phiTheta_CM_KinFit_waccsub");
	XiKhighpPhiTheta17_waccsub->Add(XiKhighpPhiTheta17_wacc,-0.5);
	XiKhighpPhiTheta17_waccsub->SetTitle("K+_{t}");
	XiKhighpPhiTheta17_waccsub->GetXaxis()->SetTitle("#theta_{CM} (deg)");
	XiKhighpPhiTheta17_waccsub->GetYaxis()->SetTitle("#phi_{CM} (deg)");
	XiKhighpPhiTheta17_waccsub->RebinX(2);
	XiKhighpPhiTheta17_waccsub->RebinY(4);
	XiKhighpPhiTheta17_waccsub->Draw("colz");
	sprintf(XiKhighpPhiTheta17name, "Xi_Khighp_phitheta_kinfit_CMframe_%s_data.png",version201701);
	ccXiKhighpPhiTheta17->Print(XiKhighpPhiTheta17name);

	char XiKlowpPhiTheta17name[100];
	TCanvas *ccXiKlowpPhiTheta17 = new TCanvas("ccXiKlowpPhiTheta17", "ccXiKlowpPhiTheta17", 800, 600);
	TH2I * XiKlowpPhiTheta17 = (TH2I*)data201701->Get("Klowp_phiTheta_Ystar_KinFit");
	TH2I * XiKlowpPhiTheta17_wacc = (TH2I*)data201701->Get("Klowp_phiTheta_Ystar_KinFit_wacc");
	TH2I * XiKlowpPhiTheta17_waccsub = (TH2I *) XiKlowpPhiTheta17->Clone("Klowp_phiTheta_Ystar_KinFit_waccsub");
	XiKlowpPhiTheta17_waccsub->Add(XiKlowpPhiTheta17_wacc,-0.5);
	XiKlowpPhiTheta17_waccsub->SetTitle("K+_{decay} in Y^{*} rest frame");
	XiKlowpPhiTheta17_waccsub->GetXaxis()->SetTitle("#theta (deg)");
	XiKlowpPhiTheta17_waccsub->GetYaxis()->SetTitle("#phi (deg)");
	XiKlowpPhiTheta17_waccsub->RebinX(2);
	XiKlowpPhiTheta17_waccsub->RebinY(4);
	XiKlowpPhiTheta17_waccsub->Draw("colz");
	sprintf(XiKlowpPhiTheta17name, "Xi_Klowp_phitheta__kinfit_Ystarframe_%s_data.png",version201701);
	ccXiKlowpPhiTheta17->Print(XiKlowpPhiTheta17name);

	char XiallKPhiTheta17MCname[100];
	TCanvas *ccXiallKPhiTheta17MC = new TCanvas("ccXiallKPhiTheta17MC", "ccXiallKPhiTheta17MC", 800, 600);
	TH2I * XiallKPhiTheta17MC = (TH2I*)mc201701->Get("allK_phiTheta_CM_KinFit");
	XiallKPhiTheta17MC->SetTitle("K+");
	XiallKPhiTheta17MC->GetXaxis()->SetTitle("#theta (deg)");
	XiallKPhiTheta17MC->GetYaxis()->SetTitle("#phi (deg)");
	XiallKPhiTheta17MC->RebinX(2);
	XiallKPhiTheta17MC->RebinY(4);
	XiallKPhiTheta17MC->Draw("colz");
	sprintf(XiallKPhiTheta17MCname, "Xi_allK_phitheta_kinfit_CMframe_%s_MC.png",version201701);
	ccXiallKPhiTheta17MC->Print(XiallKPhiTheta17MCname);

	char XiKlowpPhiTheta17MCname[100];
	TCanvas *ccXiKlowpPhiTheta17MC = new TCanvas("ccXiKlowpPhiTheta17MC", "ccXiKlowpPhiTheta17MC", 800, 600);
	TH2I * XiKlowpPhiTheta17MC = (TH2I*)mc201701->Get("Klowp_phiTheta_Ystar_KinFit");
	XiKlowpPhiTheta17MC->SetTitle("K+_{decay} in Y^{*} rest frame");
	XiKlowpPhiTheta17MC->GetXaxis()->SetTitle("#theta (deg)");
	XiKlowpPhiTheta17MC->GetYaxis()->SetTitle("#phi (deg)");
	XiKlowpPhiTheta17MC->RebinX(2);
	XiKlowpPhiTheta17MC->RebinY(4);
	XiKlowpPhiTheta17MC->Draw("colz");
	sprintf(XiKlowpPhiTheta17MCname, "Xi_Klowp_phitheta_kinfit_Ystarframe_%s_MC.png",version201701);
	ccXiKlowpPhiTheta17MC->Print(XiKlowpPhiTheta17MCname);

	char XiKhighpPhiTheta17MCname[100];
	TCanvas *ccXiKhighpPhiTheta17MC = new TCanvas("ccXiKhighpPhiTheta17MC", "ccXiKhighpPhiTheta17MC", 800, 600);
	TH2I * XiKhighpPhiTheta17MC = (TH2I*)mc201701->Get("Khighp_phiTheta_CM_KinFit");
	XiKhighpPhiTheta17MC->SetTitle("K+_{t} in CM frame");
	XiKhighpPhiTheta17MC->GetXaxis()->SetTitle("#theta (deg)");
	XiKhighpPhiTheta17MC->GetYaxis()->SetTitle("#phi (deg)");
	XiKhighpPhiTheta17MC->RebinX(2);
	XiKhighpPhiTheta17MC->RebinY(4);
	XiKhighpPhiTheta17MC->Draw("colz");
	sprintf(XiKhighpPhiTheta17MCname, "Xi_Khighp_phitheta_kinfit_CMframe_%s_MC.png",version201701);
	ccXiKhighpPhiTheta17MC->Print(XiKhighpPhiTheta17MCname);
	
	char XiKlowpPhiTheta17MCTruthname[100];
	TCanvas *ccXiKlowpPhiTheta17MCTruth = new TCanvas("ccXiKlowpPhiTheta17MCTruth", "ccXiKlowpPhiTheta17MCTruth", 800, 600);
	TH2I * XiKlowpPhiTheta17MCTruth = (TH2I*)mc201701->Get("Klowp_phiTheta_Ystar_Truth");
	XiKlowpPhiTheta17MCTruth->SetTitle("K+_{decay} in Y^{*} rest frame");
	XiKlowpPhiTheta17MCTruth->GetXaxis()->SetTitle("#theta (deg)");
	XiKlowpPhiTheta17MCTruth->GetYaxis()->SetTitle("#phi (deg)");
	XiKlowpPhiTheta17MCTruth->RebinX(2);
	XiKlowpPhiTheta17MCTruth->RebinY(4);
	XiKlowpPhiTheta17MCTruth->Draw("colz");
	sprintf(XiKlowpPhiTheta17MCTruthname, "Xi_Klowp_phitheta_kinfit_Ystarframe_%s_MCTruth.png",version201701);
	ccXiKlowpPhiTheta17MCTruth->Print(XiKlowpPhiTheta17MCTruthname);

	char XiKhighpPhiTheta17MCTruthname[100];
	TCanvas *ccXiKhighpPhiTheta17MCTruth = new TCanvas("ccXiKhighpPhiTheta17MCTruth", "ccXiKhighpPhiTheta17MCTruth", 800, 600);
	TH2I * XiKhighpPhiTheta17MCTruth = (TH2I*)mc201701->Get("Khighp_phiTheta_CM_Truth");
	XiKhighpPhiTheta17MCTruth->SetTitle("K+_{t} in CM frame");
	XiKhighpPhiTheta17MCTruth->GetXaxis()->SetTitle("#theta (deg)");
	XiKhighpPhiTheta17MCTruth->GetYaxis()->SetTitle("#phi (deg)");
	XiKhighpPhiTheta17MCTruth->RebinX(2);
	XiKhighpPhiTheta17MCTruth->RebinY(4);
	XiKhighpPhiTheta17MCTruth->Draw("colz");
	sprintf(XiKhighpPhiTheta17MCTruthname, "Xi_Khighp_phitheta_kinfit_CMframe_%s_MCTruth.png",version201701);
	ccXiKhighpPhiTheta17MCTruth->Print(XiKhighpPhiTheta17MCTruthname);

	char XiKptheta17name[100];
	TCanvas *ccXiKptheta17 = new TCanvas("ccXiKptheta17", "ccXiKptheta17", 800, 600);
	TH2I * XiKptheta17 = (TH2I*)data201701->Get("K_pTheta_Measured");	
	TH2I * XiKptheta17_wacc = (TH2I*)data201701->Get("K_pTheta_Measured_wacc");
	TH2I *XiKptheta17_waccsub = (TH2I *) XiKptheta17->Clone("XiKptheta17_waccsub");
	XiKptheta17_waccsub->Add(XiKptheta17_wacc,-0.5);
	XiKptheta17_waccsub->SetTitle("Measured K+");
	XiKptheta17_waccsub->GetXaxis()->SetTitle("#theta (deg)");
	XiKptheta17_waccsub->GetYaxis()->SetTitle("p (GeV)");
      XiKptheta17_waccsub->Draw("colz");
	sprintf(XiKptheta17name, "Xi_K_ptheta_measured_labframe_%s_data.png",version201701);
	ccXiKptheta17->Print(XiKptheta17name);

	char Xipiptheta17name[100];
	TCanvas *ccXipiptheta17 = new TCanvas("ccXipiptheta17", "ccXipiptheta17", 800, 600);
	TH2I * Xipiptheta17 = (TH2I*)data201701->Get("pi_pTheta_Measured");	
	TH2I * Xipiptheta17_wacc = (TH2I*)data201701->Get("pi_pTheta_Measured_wacc");
	TH2I *Xipiptheta17_waccsub = (TH2I *) Xipiptheta17->Clone("Xipiptheta17_waccsub");
	Xipiptheta17_waccsub->Add(Xipiptheta17_wacc,-0.5);
	Xipiptheta17_waccsub->SetTitle("Measured #pi-");
	Xipiptheta17_waccsub->GetXaxis()->SetTitle("#theta (deg)");
	Xipiptheta17_waccsub->GetYaxis()->SetTitle("p (GeV)");
        Xipiptheta17_waccsub->Draw("colz");
	sprintf(Xipiptheta17name, "Xi_pi_ptheta_measured_labframe_%s_data.png",version201701);
	ccXipiptheta17->Print(Xipiptheta17name);

	char Xipptheta17name[100];
	TCanvas *ccXipptheta17 = new TCanvas("ccXipptheta17", "ccXipptheta17", 800, 600);
	TH2I * Xipptheta17 = (TH2I*)data201701->Get("p_pTheta_Measured");	
	TH2I * Xipptheta17_wacc = (TH2I*)data201701->Get("p_pTheta_Measured_wacc");
	TH2I *Xipptheta17_waccsub = (TH2I *) Xipptheta17->Clone("Xipptheta17_waccsub");
	Xipptheta17_waccsub->Add(Xipptheta17_wacc,-0.5);
	Xipptheta17_waccsub->SetTitle("Measured Proton");
	Xipptheta17_waccsub->GetXaxis()->SetTitle("#theta (deg)");
	Xipptheta17_waccsub->GetYaxis()->SetTitle("p (GeV)");
        Xipptheta17_waccsub->Draw("colz");
	sprintf(Xipptheta17name, "Xi_p_ptheta_measured_labframe_%s_data.png",version201701);
	ccXipptheta17->Print(Xipptheta17name);

	char XiKptheta17KinFitname[100];
	TCanvas *ccXiKptheta17KinFit = new TCanvas("ccXiKptheta17KinFit", "ccXiKptheta17KinFit", 800, 600);
	TH2I * XiKptheta17KinFit = (TH2I*)data201701->Get("K_pTheta_KinFit");	
	TH2I * XiKptheta17KinFit_wacc = (TH2I*)data201701->Get("K_pTheta_KinFit_wacc");
	TH2I *XiKptheta17KinFit_waccsub = (TH2I *) XiKptheta17KinFit->Clone("XiKptheta17KinFit_waccsub");
	XiKptheta17KinFit_waccsub->Add(XiKptheta17KinFit_wacc,-0.5);
	XiKptheta17KinFit_waccsub->SetTitle("K+ p vs theta KinFit");
	XiKptheta17KinFit_waccsub->GetXaxis()->SetTitle("theta (deg)");
	XiKptheta17KinFit_waccsub->GetYaxis()->SetTitle("p (GeV)");
        XiKptheta17KinFit_waccsub->Draw("colz");
	sprintf(XiKptheta17KinFitname, "Xi_K_ptheta_KinFit_labframe_%s_data.png",version201701);
	ccXiKptheta17KinFit->Print(XiKptheta17KinFitname);

	char Xipiptheta17KinFitname[100];
	TCanvas *ccXipiptheta17KinFit = new TCanvas("ccXipiptheta17KinFit", "ccXipiptheta17KinFit", 800, 600);
	TH2I * Xipiptheta17KinFit = (TH2I*)data201701->Get("pi_pTheta_KinFit");	
	TH2I * Xipiptheta17KinFit_wacc = (TH2I*)data201701->Get("pi_pTheta_KinFit_wacc");
	TH2I *Xipiptheta17KinFit_waccsub = (TH2I *) Xipiptheta17KinFit->Clone("Xipiptheta17KinFit_waccsub");
	Xipiptheta17KinFit_waccsub->Add(Xipiptheta17KinFit_wacc,-0.5);
	Xipiptheta17KinFit_waccsub->SetTitle("pi- p vs theta KinFit");
	Xipiptheta17KinFit_waccsub->GetXaxis()->SetTitle("theta (deg)");
	Xipiptheta17KinFit_waccsub->GetYaxis()->SetTitle("p (GeV)");
        Xipiptheta17KinFit_waccsub->Draw("colz");
	sprintf(Xipiptheta17KinFitname, "Xi_pi_ptheta_KinFit_labframe_%s_data.png",version201701);
	ccXipiptheta17KinFit->Print(Xipiptheta17KinFitname);

	char Xipptheta17KinFitname[100];
	TCanvas *ccXipptheta17KinFit = new TCanvas("ccXipptheta17KinFit", "ccXipptheta17KinFit", 800, 600);
	TH2I * Xipptheta17KinFit = (TH2I*)data201701->Get("p_pTheta_KinFit");	
	TH2I * Xipptheta17KinFit_wacc = (TH2I*)data201701->Get("p_pTheta_KinFit_wacc");
	TH2I *Xipptheta17KinFit_waccsub = (TH2I *) Xipptheta17KinFit->Clone("Xipptheta17KinFit_waccsub");
	Xipptheta17KinFit_waccsub->Add(Xipptheta17KinFit_wacc,-0.5);
	Xipptheta17KinFit_waccsub->SetTitle("Proton p vs theta KinFit");
	Xipptheta17KinFit_waccsub->GetXaxis()->SetTitle("theta (deg)");
	Xipptheta17KinFit_waccsub->GetYaxis()->SetTitle("p (GeV)");
        Xipptheta17KinFit_waccsub->Draw("colz");
	sprintf(Xipptheta17KinFitname, "Xi_p_ptheta_KinFit_labframe_%s_data.png",version201701);
	ccXipptheta17KinFit->Print(Xipptheta17KinFitname);

	char XiKptheta181name[100];
	TCanvas *ccXiKptheta181 = new TCanvas("ccXiKptheta181", "ccXiKptheta181", 800, 600);
	TH2I * XiKptheta181 = (TH2I*)data201801->Get("K_pTheta_Measured");	
	TH2I * XiKptheta181_wacc = (TH2I*)data201801->Get("K_pTheta_Measured_wacc");
	TH2I *XiKptheta181_waccsub = (TH2I *) XiKptheta181->Clone("XiKptheta181_waccsub");
	XiKptheta181_waccsub->Add(XiKptheta181_wacc,-0.5);
	XiKptheta181_waccsub->SetTitle("K+ p vs theta Measured");
	XiKptheta181_waccsub->GetXaxis()->SetTitle("theta (deg)");
	XiKptheta181_waccsub->GetYaxis()->SetTitle("p (GeV)");
        XiKptheta181_waccsub->Draw("colz");
	sprintf(XiKptheta181name, "Xi_K_ptheta_measured_labframe_%s_data.png",version201801);
	ccXiKptheta181->Print(XiKptheta181name);

	char Xipiptheta181name[100];
	TCanvas *ccXipiptheta181 = new TCanvas("ccXipiptheta181", "ccXipiptheta181", 800, 600);
	TH2I * Xipiptheta181 = (TH2I*)data201801->Get("pi_pTheta_Measured");	
	TH2I * Xipiptheta181_wacc = (TH2I*)data201801->Get("pi_pTheta_Measured_wacc");
	TH2I *Xipiptheta181_waccsub = (TH2I *) Xipiptheta181->Clone("Xipiptheta181_waccsub");
	Xipiptheta181_waccsub->Add(Xipiptheta181_wacc,-0.5);
	Xipiptheta181_waccsub->SetTitle("pi- p vs theta Measured");
	Xipiptheta181_waccsub->GetXaxis()->SetTitle("theta (deg)");
	Xipiptheta181_waccsub->GetYaxis()->SetTitle("p (GeV)");
        Xipiptheta181_waccsub->Draw("colz");
	sprintf(Xipiptheta181name, "Xi_pi_ptheta_measured_labframe_%s_data.png",version201801);
	ccXipiptheta181->Print(Xipiptheta181name);

	char Xipptheta181name[100];
	TCanvas *ccXipptheta181 = new TCanvas("ccXipptheta181", "ccXipptheta181", 800, 600);
	TH2I * Xipptheta181 = (TH2I*)data201801->Get("p_pTheta_Measured");	
	TH2I * Xipptheta181_wacc = (TH2I*)data201801->Get("p_pTheta_Measured_wacc");
	TH2I *Xipptheta181_waccsub = (TH2I *) Xipptheta181->Clone("Xipptheta181_waccsub");
	Xipptheta181_waccsub->Add(Xipptheta181_wacc,-0.5);
	Xipptheta181_waccsub->SetTitle("Proton p vs theta Measured");
	Xipptheta181_waccsub->GetXaxis()->SetTitle("theta (deg)");
	Xipptheta181_waccsub->GetYaxis()->SetTitle("p (GeV)");
        Xipptheta181_waccsub->Draw("colz");
	sprintf(Xipptheta181name, "Xi_p_ptheta_measured_labframe_%s_data.png",version201801);
	ccXipptheta181->Print(Xipptheta181name);

	char XiKptheta181KinFitname[100];
	TCanvas *ccXiKptheta181KinFit = new TCanvas("ccXiKptheta181KinFit", "ccXiKptheta181KinFit", 800, 600);
	TH2I * XiKptheta181KinFit = (TH2I*)data201801->Get("K_pTheta_KinFit");	
	TH2I * XiKptheta181KinFit_wacc = (TH2I*)data201801->Get("K_pTheta_KinFit_wacc");
	TH2I *XiKptheta181KinFit_waccsub = (TH2I *) XiKptheta181KinFit->Clone("XiKptheta181KinFit_waccsub");
	XiKptheta181KinFit_waccsub->Add(XiKptheta181KinFit_wacc,-0.5);
	XiKptheta181KinFit_waccsub->SetTitle("K+ p vs theta KinFit");
	XiKptheta181KinFit_waccsub->GetXaxis()->SetTitle("theta (deg)");
	XiKptheta181KinFit_waccsub->GetYaxis()->SetTitle("p (GeV)");
        XiKptheta181KinFit_waccsub->Draw("colz");
	sprintf(XiKptheta181KinFitname, "Xi_K_ptheta_KinFit_labframe_%s_data.png",version201801);
	ccXiKptheta181KinFit->Print(XiKptheta181KinFitname);

	char Xipiptheta181KinFitname[100];
	TCanvas *ccXipiptheta181KinFit = new TCanvas("ccXipiptheta181KinFit", "ccXipiptheta181KinFit", 800, 600);
	TH2I * Xipiptheta181KinFit = (TH2I*)data201801->Get("pi_pTheta_KinFit");	
	TH2I * Xipiptheta181KinFit_wacc = (TH2I*)data201801->Get("pi_pTheta_KinFit_wacc");
	TH2I *Xipiptheta181KinFit_waccsub = (TH2I *) Xipiptheta181KinFit->Clone("Xipiptheta181KinFit_waccsub");
	Xipiptheta181KinFit_waccsub->Add(Xipiptheta181KinFit_wacc,-0.5);
	Xipiptheta181KinFit_waccsub->SetTitle("pi- p vs theta KinFit");
	Xipiptheta181KinFit_waccsub->GetXaxis()->SetTitle("theta (deg)");
	Xipiptheta181KinFit_waccsub->GetYaxis()->SetTitle("p (GeV)");
        Xipiptheta181KinFit_waccsub->Draw("colz");
	sprintf(Xipiptheta181KinFitname, "Xi_pi_ptheta_KinFit_labframe_%s_data.png",version201801);
	ccXipiptheta181KinFit->Print(Xipiptheta181KinFitname);

	char Xipptheta181KinFitname[100];
	TCanvas *ccXipptheta181KinFit = new TCanvas("ccXipptheta181KinFit", "ccXipptheta181KinFit", 800, 600);
	TH2I * Xipptheta181KinFit = (TH2I*)data201801->Get("p_pTheta_KinFit");	
	TH2I * Xipptheta181KinFit_wacc = (TH2I*)data201801->Get("p_pTheta_KinFit_wacc");
	TH2I *Xipptheta181KinFit_waccsub = (TH2I *) Xipptheta181KinFit->Clone("Xipptheta181KinFit_waccsub");
	Xipptheta181KinFit_waccsub->Add(Xipptheta181KinFit_wacc,-0.5);
	Xipptheta181KinFit_waccsub->SetTitle("Proton p vs theta KinFit");
	Xipptheta181KinFit_waccsub->GetXaxis()->SetTitle("theta (deg)");
	Xipptheta181KinFit_waccsub->GetYaxis()->SetTitle("p (GeV)");
        Xipptheta181KinFit_waccsub->Draw("colz");
	sprintf(Xipptheta181KinFitname, "Xi_p_ptheta_KinFit_labframe_%s_data.png",version201801);
	ccXipptheta181KinFit->Print(Xipptheta181KinFitname);

	char XiKptheta188name[100];
	TCanvas *ccXiKptheta188 = new TCanvas("ccXiKptheta188", "ccXiKptheta188", 800, 600);
	TH2I * XiKptheta188 = (TH2I*)data201808->Get("K_pTheta_Measured");	
	TH2I * XiKptheta188_wacc = (TH2I*)data201808->Get("K_pTheta_Measured_wacc");
	TH2I *XiKptheta188_waccsub = (TH2I *) XiKptheta188->Clone("XiKptheta188_waccsub");
	XiKptheta188_waccsub->Add(XiKptheta188_wacc,-0.5);
	XiKptheta188_waccsub->SetTitle("K+ p vs theta Measured");
	XiKptheta188_waccsub->GetXaxis()->SetTitle("theta (deg)");
	XiKptheta188_waccsub->GetYaxis()->SetTitle("p (GeV)");
        XiKptheta188_waccsub->Draw("colz");
	sprintf(XiKptheta188name, "Xi_K_ptheta_measured_labframe_%s_data.png",version201808);
	ccXiKptheta188->Print(XiKptheta188name);

	char Xipiptheta188name[100];
	TCanvas *ccXipiptheta188 = new TCanvas("ccXipiptheta188", "ccXipiptheta188", 800, 600);
	TH2I * Xipiptheta188 = (TH2I*)data201808->Get("pi_pTheta_Measured");	
	TH2I * Xipiptheta188_wacc = (TH2I*)data201808->Get("pi_pTheta_Measured_wacc");
	TH2I *Xipiptheta188_waccsub = (TH2I *) Xipiptheta188->Clone("Xipiptheta188_waccsub");
	Xipiptheta188_waccsub->Add(Xipiptheta188_wacc,-0.5);
	Xipiptheta188_waccsub->SetTitle("pi- p vs theta Measured");
	Xipiptheta188_waccsub->GetXaxis()->SetTitle("theta (deg)");
	Xipiptheta188_waccsub->GetYaxis()->SetTitle("p (GeV)");
        Xipiptheta188_waccsub->Draw("colz");
	sprintf(Xipiptheta188name, "Xi_pi_ptheta_measured_labframe_%s_data.png",version201808);
	ccXipiptheta188->Print(Xipiptheta188name);

	char Xipptheta188name[100];
	TCanvas *ccXipptheta188 = new TCanvas("ccXipptheta188", "ccXipptheta188", 800, 600);
	TH2I * Xipptheta188 = (TH2I*)data201808->Get("p_pTheta_Measured");	
	TH2I * Xipptheta188_wacc = (TH2I*)data201808->Get("p_pTheta_Measured_wacc");
	TH2I *Xipptheta188_waccsub = (TH2I *) Xipptheta188->Clone("Xipptheta188_waccsub");
	Xipptheta188_waccsub->Add(Xipptheta188_wacc,-0.5);
	Xipptheta188_waccsub->SetTitle("Proton p vs theta Measured");
	Xipptheta188_waccsub->GetXaxis()->SetTitle("theta (deg)");
	Xipptheta188_waccsub->GetYaxis()->SetTitle("p (GeV)");
        Xipptheta188_waccsub->Draw("colz");
	sprintf(Xipptheta188name, "Xi_p_ptheta_measured_labframe_%s_data.png",version201808);
	ccXipptheta188->Print(Xipptheta188name);

	char XiKptheta188KinFitname[100];
	TCanvas *ccXiKptheta188KinFit = new TCanvas("ccXiKptheta188KinFit", "ccXiKptheta188KinFit", 800, 600);
	TH2I * XiKptheta188KinFit = (TH2I*)data201808->Get("K_pTheta_KinFit");	
	TH2I * XiKptheta188KinFit_wacc = (TH2I*)data201808->Get("K_pTheta_KinFit_wacc");
	TH2I *XiKptheta188KinFit_waccsub = (TH2I *) XiKptheta188KinFit->Clone("XiKptheta188KinFit_waccsub");
	XiKptheta188KinFit_waccsub->Add(XiKptheta188KinFit_wacc,-0.5);
	XiKptheta188KinFit_waccsub->SetTitle("K+ p vs theta KinFit");
	XiKptheta188KinFit_waccsub->GetXaxis()->SetTitle("theta (deg)");
	XiKptheta188KinFit_waccsub->GetYaxis()->SetTitle("p (GeV)");
        XiKptheta188KinFit_waccsub->Draw("colz");
	sprintf(XiKptheta188KinFitname, "Xi_K_ptheta_kinfit_labframe_%s_data.png",version201808);
	ccXiKptheta188KinFit->Print(XiKptheta188KinFitname);

	char Xipiptheta188KinFitname[100];
	TCanvas *ccXipiptheta188KinFit = new TCanvas("ccXipiptheta188KinFit", "ccXipiptheta188KinFit", 800, 600);
	TH2I * Xipiptheta188KinFit = (TH2I*)data201808->Get("pi_pTheta_KinFit");	
	TH2I * Xipiptheta188KinFit_wacc = (TH2I*)data201808->Get("pi_pTheta_KinFit_wacc");
	TH2I *Xipiptheta188KinFit_waccsub = (TH2I *) Xipiptheta188KinFit->Clone("Xipiptheta188KinFit_waccsub");
	Xipiptheta188KinFit_waccsub->Add(Xipiptheta188KinFit_wacc,-0.5);
	Xipiptheta188KinFit_waccsub->SetTitle("pi- p vs theta KinFit");
	Xipiptheta188KinFit_waccsub->GetXaxis()->SetTitle("theta (deg)");
	Xipiptheta188KinFit_waccsub->GetYaxis()->SetTitle("p (GeV)");
        Xipiptheta188KinFit_waccsub->Draw("colz");
	sprintf(Xipiptheta188KinFitname, "Xi_pi_ptheta_kinfit_labframe_%s_data.png",version201808);
	ccXipiptheta188KinFit->Print(Xipiptheta188KinFitname);

	char Xipptheta188KinFitname[100];
	TCanvas *ccXipptheta188KinFit = new TCanvas("ccXipptheta188KinFit", "ccXipptheta188KinFit", 800, 600);
	TH2I * Xipptheta188KinFit = (TH2I*)data201808->Get("p_pTheta_KinFit");	
	TH2I * Xipptheta188KinFit_wacc = (TH2I*)data201808->Get("p_pTheta_KinFit_wacc");
	TH2I *Xipptheta188KinFit_waccsub = (TH2I *) Xipptheta188KinFit->Clone("Xipptheta188KinFit_waccsub");
	Xipptheta188KinFit_waccsub->Add(Xipptheta188KinFit_wacc,-0.5);
	Xipptheta188KinFit_waccsub->SetTitle("Proton p vs theta KinFit");
	Xipptheta188KinFit_waccsub->GetXaxis()->SetTitle("theta (deg)");
	Xipptheta188KinFit_waccsub->GetYaxis()->SetTitle("p (GeV)");
        Xipptheta188KinFit_waccsub->Draw("colz");
	sprintf(Xipptheta188KinFitname, "Xi_p_ptheta_kinfit_labframe_%s_data.png",version201808);
	ccXipptheta188KinFit->Print(Xipptheta188KinFitname);


	char XiKptheta171MCname[100];
	TCanvas *ccXiKptheta171MC = new TCanvas("ccXiKptheta171MC", "ccXiKptheta171MC", 800, 600);
	TH2I * XiKptheta171MC = (TH2I*)mc201701->Get("K_pTheta_Measured");	
	TH2I * XiKptheta171MC_wacc = (TH2I*)mc201701->Get("K_pTheta_Measured_wacc");
	TH2I *XiKptheta171MC_waccsub = (TH2I *) XiKptheta171MC->Clone("XiKptheta171MC_waccsub");
	XiKptheta171MC_waccsub->Add(XiKptheta171MC_wacc,-0.5);
	XiKptheta171MC_waccsub->SetTitle("K+ p vs theta Measured");
	XiKptheta171MC_waccsub->GetXaxis()->SetTitle("theta (deg)");
	XiKptheta171MC_waccsub->GetYaxis()->SetTitle("p (GeV)");
        XiKptheta171MC_waccsub->Draw("colz");
	sprintf(XiKptheta171MCname, "Xi_K_ptheta_measured_labframe_%s_MC.png",version201701);
	ccXiKptheta171MC->Print(XiKptheta171MCname);

	char Xipiptheta171MCname[100];
	TCanvas *ccXipiptheta171MC = new TCanvas("ccXipiptheta171MC", "ccXipiptheta171MC", 800, 600);
	TH2I * Xipiptheta171MC = (TH2I*)mc201701->Get("pi_pTheta_Measured");	
	TH2I * Xipiptheta171MC_wacc = (TH2I*)mc201701->Get("pi_pTheta_Measured_wacc");
	TH2I *Xipiptheta171MC_waccsub = (TH2I *) Xipiptheta171MC->Clone("Xipiptheta171MC_waccsub");
	Xipiptheta171MC_waccsub->Add(Xipiptheta171MC_wacc,-0.5);
	Xipiptheta171MC_waccsub->SetTitle("pi- p vs theta Measured");
	Xipiptheta171MC_waccsub->GetXaxis()->SetTitle("theta (deg)");
	Xipiptheta171MC_waccsub->GetYaxis()->SetTitle("p (GeV)");
        Xipiptheta171MC_waccsub->Draw("colz");
	sprintf(Xipiptheta171MCname, "Xi_pi_ptheta_measured_labframe_%s_MC.png",version201701);
	ccXipiptheta171MC->Print(Xipiptheta171MCname);

	char Xipptheta171MCname[100];
	TCanvas *ccXipptheta171MC = new TCanvas("ccXipptheta171MC", "ccXipptheta171MC", 800, 600);
	TH2I * Xipptheta171MC = (TH2I*)mc201701->Get("p_pTheta_Measured");	
	TH2I * Xipptheta171MC_wacc = (TH2I*)mc201701->Get("p_pTheta_Measured_wacc");
	TH2I *Xipptheta171MC_waccsub = (TH2I *) Xipptheta171MC->Clone("Xipptheta171MC_waccsub");
	Xipptheta171MC_waccsub->Add(Xipptheta171MC_wacc,-0.5);
	Xipptheta171MC_waccsub->SetTitle("Proton p vs theta Measured");
	Xipptheta171MC_waccsub->GetXaxis()->SetTitle("theta (deg)");
	Xipptheta171MC_waccsub->GetYaxis()->SetTitle("p (GeV)");
        Xipptheta171MC_waccsub->Draw("colz");
	sprintf(Xipptheta171MCname, "Xi_p_ptheta_measured_labframe_%s_MC.png",version201701);
	ccXipptheta171MC->Print(Xipptheta171MCname);

	char XiKptheta171MCKinFitname[100];
	TCanvas *ccXiKptheta171MCKinFit = new TCanvas("ccXiKptheta171MCKinFit", "ccXiKptheta171MCKinFit", 800, 600);
	TH2I * XiKptheta171MCKinFit = (TH2I*)mc201701->Get("K_pTheta_KinFit");	
	TH2I * XiKptheta171MCKinFit_wacc = (TH2I*)mc201701->Get("K_pTheta_KinFit_wacc");
	TH2I *XiKptheta171MCKinFit_waccsub = (TH2I *) XiKptheta171MCKinFit->Clone("XiKptheta171MCKinFit_waccsub");
	XiKptheta171MCKinFit_waccsub->Add(XiKptheta171MCKinFit_wacc,-0.5);
	XiKptheta171MCKinFit_waccsub->SetTitle("K+ p vs theta KinFit");
	XiKptheta171MCKinFit_waccsub->GetXaxis()->SetTitle("theta (deg)");
	XiKptheta171MCKinFit_waccsub->GetYaxis()->SetTitle("p (GeV)");
        XiKptheta171MCKinFit_waccsub->Draw("colz");
	sprintf(XiKptheta171MCKinFitname, "Xi_K_ptheta_kinfit_labframe_%s_MC.png",version201701);
	ccXiKptheta171MCKinFit->Print(XiKptheta171MCKinFitname);

	char Xipiptheta171MCKinFitname[100];
	TCanvas *ccXipiptheta171MCKinFit = new TCanvas("ccXipiptheta171MCKinFit", "ccXipiptheta171MCKinFit", 800, 600);
	TH2I * Xipiptheta171MCKinFit = (TH2I*)mc201701->Get("pi_pTheta_KinFit");	
	TH2I * Xipiptheta171MCKinFit_wacc = (TH2I*)mc201701->Get("pi_pTheta_KinFit_wacc");
	TH2I *Xipiptheta171MCKinFit_waccsub = (TH2I *) Xipiptheta171MCKinFit->Clone("Xipiptheta171MCKinFit_waccsub");
	Xipiptheta171MCKinFit_waccsub->Add(Xipiptheta171MCKinFit_wacc,-0.5);
	Xipiptheta171MCKinFit_waccsub->SetTitle("pi- p vs theta KinFit");
	Xipiptheta171MCKinFit_waccsub->GetXaxis()->SetTitle("theta (deg)");
	Xipiptheta171MCKinFit_waccsub->GetYaxis()->SetTitle("p (GeV)");
        Xipiptheta171MCKinFit_waccsub->Draw("colz");
	sprintf(Xipiptheta171MCKinFitname, "Xi_pi_ptheta_kinfit_labframe_%s_MC.png",version201701);
	ccXipiptheta171MCKinFit->Print(Xipiptheta171MCKinFitname);

	char Xipptheta171MCKinFitname[100];
	TCanvas *ccXipptheta171MCKinFit = new TCanvas("ccXipptheta171MCKinFit", "ccXipptheta171MCKinFit", 800, 600);
	TH2I * Xipptheta171MCKinFit = (TH2I*)mc201701->Get("p_pTheta_KinFit");	
	TH2I * Xipptheta171MCKinFit_wacc = (TH2I*)mc201701->Get("p_pTheta_KinFit_wacc");
	TH2I *Xipptheta171MCKinFit_waccsub = (TH2I *) Xipptheta171MCKinFit->Clone("Xipptheta171MCKinFit_waccsub");
	Xipptheta171MCKinFit_waccsub->Add(Xipptheta171MCKinFit_wacc,-0.5);
	Xipptheta171MCKinFit_waccsub->SetTitle("Proton p vs theta KinFit");
	Xipptheta171MCKinFit_waccsub->GetXaxis()->SetTitle("theta (deg)");
	Xipptheta171MCKinFit_waccsub->GetYaxis()->SetTitle("p (GeV)");
        Xipptheta171MCKinFit_waccsub->Draw("colz");
	sprintf(Xipptheta171MCKinFitname, "Xi_p_ptheta_kinfit_labframe_%s_MC.png",version201701);
	ccXipptheta171MCKinFit->Print(Xipptheta171MCKinFitname);

	char XiKptheta181MCname[100];
	TCanvas *ccXiKptheta181MC = new TCanvas("ccXiKptheta181MC", "ccXiKptheta181MC", 800, 600);
	TH2I * XiKptheta181MC = (TH2I*)mc201801->Get("K_pTheta_Measured");	
	TH2I * XiKptheta181MC_wacc = (TH2I*)mc201801->Get("K_pTheta_Measured_wacc");
	TH2I *XiKptheta181MC_waccsub = (TH2I *) XiKptheta181MC->Clone("XiKptheta181MC_waccsub");
	XiKptheta181MC_waccsub->Add(XiKptheta181MC_wacc,-0.5);
	XiKptheta181MC_waccsub->SetTitle("K+ p vs theta Measured");
	XiKptheta181MC_waccsub->GetXaxis()->SetTitle("theta (deg)");
	XiKptheta181MC_waccsub->GetYaxis()->SetTitle("p (GeV)");
        XiKptheta181MC_waccsub->Draw("colz");
	sprintf(XiKptheta181MCname, "Xi_K_ptheta_measured_labframe_%s_MC.png",version201801);
	ccXiKptheta181MC->Print(XiKptheta181MCname);

	char Xipiptheta181MCname[100];
	TCanvas *ccXipiptheta181MC = new TCanvas("ccXipiptheta181MC", "ccXipiptheta181MC", 800, 600);
	TH2I * Xipiptheta181MC = (TH2I*)mc201801->Get("pi_pTheta_Measured");	
	TH2I * Xipiptheta181MC_wacc = (TH2I*)mc201801->Get("pi_pTheta_Measured_wacc");
	TH2I *Xipiptheta181MC_waccsub = (TH2I *) Xipiptheta181MC->Clone("Xipiptheta181MC_waccsub");
	Xipiptheta181MC_waccsub->Add(Xipiptheta181MC_wacc,-0.5);
	Xipiptheta181MC_waccsub->SetTitle("pi- p vs theta Measured");
	Xipiptheta181MC_waccsub->GetXaxis()->SetTitle("theta (deg)");
	Xipiptheta181MC_waccsub->GetYaxis()->SetTitle("p (GeV)");
        Xipiptheta181MC_waccsub->Draw("colz");
	sprintf(Xipiptheta181MCname, "Xi_pi_ptheta_measured_labframe_%s_MC.png",version201801);
	ccXipiptheta181MC->Print(Xipiptheta181MCname);

	char Xipptheta181MCname[100];
	TCanvas *ccXipptheta181MC = new TCanvas("ccXipptheta181MC", "ccXipptheta181MC", 800, 600);
	TH2I * Xipptheta181MC = (TH2I*)mc201801->Get("p_pTheta_Measured");	
	TH2I * Xipptheta181MC_wacc = (TH2I*)mc201801->Get("p_pTheta_Measured_wacc");
	TH2I *Xipptheta181MC_waccsub = (TH2I *) Xipptheta181MC->Clone("Xipptheta181MC_waccsub");
	Xipptheta181MC_waccsub->Add(Xipptheta181MC_wacc,-0.5);
	Xipptheta181MC_waccsub->SetTitle("Proton p vs theta Measured");
	Xipptheta181MC_waccsub->GetXaxis()->SetTitle("theta (deg)");
	Xipptheta181MC_waccsub->GetYaxis()->SetTitle("p (GeV)");
        Xipptheta181MC_waccsub->Draw("colz");
	sprintf(Xipptheta181MCname, "Xi_p_ptheta_measured_labframe_%s_MC.png",version201801);
	ccXipptheta181MC->Print(Xipptheta181MCname);

	char XiKptheta181MCKinFitname[100];
	TCanvas *ccXiKptheta181MCKinFit = new TCanvas("ccXiKptheta181MCKinFit", "ccXiKptheta181MCKinFit", 800, 600);
	TH2I * XiKptheta181MCKinFit = (TH2I*)mc201801->Get("K_pTheta_KinFit");	
	TH2I * XiKptheta181MCKinFit_wacc = (TH2I*)mc201801->Get("K_pTheta_KinFit_wacc");
	TH2I *XiKptheta181MCKinFit_waccsub = (TH2I *) XiKptheta181MCKinFit->Clone("XiKptheta181MCKinFit_waccsub");
	XiKptheta181MCKinFit_waccsub->Add(XiKptheta181MCKinFit_wacc,-0.5);
	XiKptheta181MCKinFit_waccsub->SetTitle("K+ p vs theta KinFit");
	XiKptheta181MCKinFit_waccsub->GetXaxis()->SetTitle("theta (deg)");
	XiKptheta181MCKinFit_waccsub->GetYaxis()->SetTitle("p (GeV)");
        XiKptheta181MCKinFit_waccsub->Draw("colz");
	sprintf(XiKptheta181MCKinFitname, "Xi_K_ptheta_kinfit_labframe_%s_MC.png",version201801);
	ccXiKptheta181MCKinFit->Print(XiKptheta181MCKinFitname);

	char Xipiptheta181MCKinFitname[100];
	TCanvas *ccXipiptheta181MCKinFit = new TCanvas("ccXipiptheta181MCKinFit", "ccXipiptheta181MCKinFit", 800, 600);
	TH2I * Xipiptheta181MCKinFit = (TH2I*)mc201801->Get("pi_pTheta_KinFit");	
	TH2I * Xipiptheta181MCKinFit_wacc = (TH2I*)mc201801->Get("pi_pTheta_KinFit_wacc");
	TH2I *Xipiptheta181MCKinFit_waccsub = (TH2I *) Xipiptheta181MCKinFit->Clone("Xipiptheta181MCKinFit_waccsub");
	Xipiptheta181MCKinFit_waccsub->Add(Xipiptheta181MCKinFit_wacc,-0.5);
	Xipiptheta181MCKinFit_waccsub->SetTitle("pi- p vs theta KinFit");
	Xipiptheta181MCKinFit_waccsub->GetXaxis()->SetTitle("theta (deg)");
	Xipiptheta181MCKinFit_waccsub->GetYaxis()->SetTitle("p (GeV)");
        Xipiptheta181MCKinFit_waccsub->Draw("colz");
	sprintf(Xipiptheta181MCKinFitname, "Xi_pi_ptheta_kinfit_labframe_%s_MC.png",version201801);
	ccXipiptheta181MCKinFit->Print(Xipiptheta181MCKinFitname);

	char Xipptheta181MCKinFitname[100];
	TCanvas *ccXipptheta181MCKinFit = new TCanvas("ccXipptheta181MCKinFit", "ccXipptheta181MCKinFit", 800, 600);
	TH2I * Xipptheta181MCKinFit = (TH2I*)mc201801->Get("p_pTheta_KinFit");	
	TH2I * Xipptheta181MCKinFit_wacc = (TH2I*)mc201801->Get("p_pTheta_KinFit_wacc");
	TH2I *Xipptheta181MCKinFit_waccsub = (TH2I *) Xipptheta181MCKinFit->Clone("Xipptheta181MCKinFit_waccsub");
	Xipptheta181MCKinFit_waccsub->Add(Xipptheta181MCKinFit_wacc,-0.5);
	Xipptheta181MCKinFit_waccsub->SetTitle("Proton p vs theta KinFit");
	Xipptheta181MCKinFit_waccsub->GetXaxis()->SetTitle("theta (deg)");
	Xipptheta181MCKinFit_waccsub->GetYaxis()->SetTitle("p (GeV)");
        Xipptheta181MCKinFit_waccsub->Draw("colz");
	sprintf(Xipptheta181MCKinFitname, "Xi_p_ptheta_kinfit_labframe_%s_MC.png",version201801);
	ccXipptheta181MCKinFit->Print(Xipptheta181MCKinFitname);

	char XiKptheta188MCname[100];
	TCanvas *ccXiKptheta188MC = new TCanvas("ccXiKptheta188MC", "ccXiKptheta188MC", 800, 600);
	TH2I * XiKptheta188MC = (TH2I*)mc201808->Get("K_pTheta_Measured");	
	TH2I * XiKptheta188MC_wacc = (TH2I*)mc201808->Get("K_pTheta_Measured_wacc");
	TH2I *XiKptheta188MC_waccsub = (TH2I *) XiKptheta188MC->Clone("XiKptheta188MC_waccsub");
	XiKptheta188MC_waccsub->Add(XiKptheta188MC_wacc,-0.5);
	XiKptheta188MC_waccsub->SetTitle("K+ p vs theta Measured");
	XiKptheta188MC_waccsub->GetXaxis()->SetTitle("theta (deg)");
	XiKptheta188MC_waccsub->GetYaxis()->SetTitle("p (GeV)");
        XiKptheta188MC_waccsub->Draw("colz");
	sprintf(XiKptheta188MCname, "Xi_K_ptheta_measured_labframe_%s_MC.png",version201808);
	ccXiKptheta188MC->Print(XiKptheta188MCname);

	char Xipiptheta188MCname[100];
	TCanvas *ccXipiptheta188MC = new TCanvas("ccXipiptheta188MC", "ccXipiptheta188MC", 800, 600);
	TH2I * Xipiptheta188MC = (TH2I*)mc201808->Get("pi_pTheta_Measured");	
	TH2I * Xipiptheta188MC_wacc = (TH2I*)mc201808->Get("pi_pTheta_Measured_wacc");
	TH2I *Xipiptheta188MC_waccsub = (TH2I *) Xipiptheta188MC->Clone("Xipiptheta188MC_waccsub");
	Xipiptheta188MC_waccsub->Add(Xipiptheta188MC_wacc,-0.5);
	Xipiptheta188MC_waccsub->SetTitle("pi- p vs theta Measured");
	Xipiptheta188MC_waccsub->GetXaxis()->SetTitle("theta (deg)");
	Xipiptheta188MC_waccsub->GetYaxis()->SetTitle("p (GeV)");
        Xipiptheta188MC_waccsub->Draw("colz");
	sprintf(Xipiptheta188MCname, "Xi_pi_ptheta_measured_labframe_%s_MC.png",version201808);
	ccXipiptheta188MC->Print(Xipiptheta188MCname);

	char Xipptheta188MCname[100];
	TCanvas *ccXipptheta188MC = new TCanvas("ccXipptheta188MC", "ccXipptheta188MC", 800, 600);
	TH2I * Xipptheta188MC = (TH2I*)mc201808->Get("p_pTheta_Measured");	
	TH2I * Xipptheta188MC_wacc = (TH2I*)mc201808->Get("p_pTheta_Measured_wacc");
	TH2I *Xipptheta188MC_waccsub = (TH2I *) Xipptheta188MC->Clone("Xipptheta188MC_waccsub");
	Xipptheta188MC_waccsub->Add(Xipptheta188MC_wacc,-0.5);
	Xipptheta188MC_waccsub->SetTitle("Proton p vs theta Measured");
	Xipptheta188MC_waccsub->GetXaxis()->SetTitle("theta (deg)");
	Xipptheta188MC_waccsub->GetYaxis()->SetTitle("p (GeV)");
        Xipptheta188MC_waccsub->Draw("colz");
	sprintf(Xipptheta188MCname, "Xi_p_ptheta_measured_labframe_%s_MC.png",version201808);
	ccXipptheta188MC->Print(Xipptheta188MCname);

	char XiKptheta188MCKinFitname[100];
	TCanvas *ccXiKptheta188MCKinFit = new TCanvas("ccXiKptheta188MCKinFit", "ccXiKptheta188MCKinFit", 800, 600);
	TH2I * XiKptheta188MCKinFit = (TH2I*)mc201808->Get("K_pTheta_KinFit");	
	TH2I * XiKptheta188MCKinFit_wacc = (TH2I*)mc201808->Get("K_pTheta_KinFit_wacc");
	TH2I *XiKptheta188MCKinFit_waccsub = (TH2I *) XiKptheta188MCKinFit->Clone("XiKptheta188MCKinFit_waccsub");
	XiKptheta188MCKinFit_waccsub->Add(XiKptheta188MCKinFit_wacc,-0.5);
	XiKptheta188MCKinFit_waccsub->SetTitle("K+ p vs theta KinFit");
	XiKptheta188MCKinFit_waccsub->GetXaxis()->SetTitle("theta (deg)");
	XiKptheta188MCKinFit_waccsub->GetYaxis()->SetTitle("p (GeV)");
        XiKptheta188MCKinFit_waccsub->Draw("colz");
	sprintf(XiKptheta188MCKinFitname, "Xi_K_ptheta_kinfit_labframe_%s_MC.png",version201808);
	ccXiKptheta188MCKinFit->Print(XiKptheta188MCKinFitname);

	char Xipiptheta188MCKinFitname[100];
	TCanvas *ccXipiptheta188MCKinFit = new TCanvas("ccXipiptheta188MCKinFit", "ccXipiptheta188MCKinFit", 800, 600);
	TH2I * Xipiptheta188MCKinFit = (TH2I*)mc201808->Get("pi_pTheta_KinFit");	
	TH2I * Xipiptheta188MCKinFit_wacc = (TH2I*)mc201808->Get("pi_pTheta_KinFit_wacc");
	TH2I *Xipiptheta188MCKinFit_waccsub = (TH2I *) Xipiptheta188MCKinFit->Clone("Xipiptheta188MCKinFit_waccsub");
	Xipiptheta188MCKinFit_waccsub->Add(Xipiptheta188MCKinFit_wacc,-0.5);
	Xipiptheta188MCKinFit_waccsub->SetTitle("pi- p vs theta KinFit");
	Xipiptheta188MCKinFit_waccsub->GetXaxis()->SetTitle("theta (deg)");
	Xipiptheta188MCKinFit_waccsub->GetYaxis()->SetTitle("p (GeV)");
        Xipiptheta188MCKinFit_waccsub->Draw("colz");
	sprintf(Xipiptheta188MCKinFitname, "Xi_pi_ptheta_kinfit_labframe_%s_MC.png",version201808);
	ccXipiptheta188MCKinFit->Print(Xipiptheta188MCKinFitname);

	char Xipptheta188MCKinFitname[100];
	TCanvas *ccXipptheta188MCKinFit = new TCanvas("ccXipptheta188MCKinFit", "ccXipptheta188MCKinFit", 800, 600);
	TH2I * Xipptheta188MCKinFit = (TH2I*)mc201808->Get("p_pTheta_KinFit");	
	TH2I * Xipptheta188MCKinFit_wacc = (TH2I*)mc201808->Get("p_pTheta_KinFit_wacc");
	TH2I *Xipptheta188MCKinFit_waccsub = (TH2I *) Xipptheta188MCKinFit->Clone("Xipptheta188MCKinFit_waccsub");
	Xipptheta188MCKinFit_waccsub->Add(Xipptheta188MCKinFit_wacc,-0.5);	
	Xipptheta188MCKinFit_waccsub->SetTitle("Proton p vs theta KinFit");
	Xipptheta188MCKinFit_waccsub->GetXaxis()->SetTitle("theta (deg)");
	Xipptheta188MCKinFit_waccsub->GetYaxis()->SetTitle("p (GeV)");
        Xipptheta188MCKinFit_waccsub->Draw("colz");
	sprintf(Xipptheta188MCKinFitname, "Xi_p_ptheta_kinfit_labframe_%s_MC.png",version201808);
	ccXipptheta188MCKinFit->Print(Xipptheta188MCKinFitname);


	TH1F * Kp171 = (TH1F *)XiKptheta17_waccsub->ProjectionY("Kp171",1,XiKptheta17_waccsub->GetXaxis()->FindBin(140));
	TH1F * Kp181 = (TH1F *)XiKptheta181_waccsub->ProjectionY("Kp181",1,XiKptheta181_waccsub->GetXaxis()->FindBin(140));
	TH1F * Kp188 = (TH1F *)XiKptheta188_waccsub->ProjectionY("Kp188",1,XiKptheta188_waccsub->GetXaxis()->FindBin(140));
	TH1F * Kp171MC = (TH1F *)XiKptheta171MC_waccsub->ProjectionY("Kp171MC",1,XiKptheta171MC_waccsub->GetXaxis()->FindBin(140));
	TH1F * Kp181MC = (TH1F *)XiKptheta181MC_waccsub->ProjectionY("Kp181MC",1,XiKptheta181MC_waccsub->GetXaxis()->FindBin(140));
	TH1F * Kp188MC = (TH1F *)XiKptheta188MC_waccsub->ProjectionY("Kp188MC",1,XiKptheta188MC_waccsub->GetXaxis()->FindBin(140));
	TH1F * Ktheta171 = (TH1F *)XiKptheta17_waccsub->ProjectionX("Ktheta171",1,XiKptheta17_waccsub->GetYaxis()->FindBin(10.));
	TH1F * Ktheta181 = (TH1F *)XiKptheta181_waccsub->ProjectionX("Ktheta181",1,XiKptheta181_waccsub->GetYaxis()->FindBin(10));
	TH1F * Ktheta188 = (TH1F *)XiKptheta188_waccsub->ProjectionX("Ktheta188",1,XiKptheta188_waccsub->GetYaxis()->FindBin(10));
	TH1F * Ktheta171MC = (TH1F *)XiKptheta171MC_waccsub->ProjectionX("Ktheta171MC",1,XiKptheta171MC_waccsub->GetYaxis()->FindBin(10));
	TH1F * Ktheta181MC = (TH1F *)XiKptheta181MC_waccsub->ProjectionX("Ktheta181MC",1,XiKptheta181MC_waccsub->GetYaxis()->FindBin(10));
	TH1F * Ktheta188MC = (TH1F *)XiKptheta188MC_waccsub->ProjectionX("Ktheta188MC",1,XiKptheta188MC_waccsub->GetYaxis()->FindBin(10));

	TH1F * Pp171 = (TH1F *)Xipptheta17_waccsub->ProjectionY("Pp171",1,Xipptheta17_waccsub->GetXaxis()->FindBin(140));
	TH1F * Pp181 = (TH1F *)Xipptheta181_waccsub->ProjectionY("Pp181",1,Xipptheta181_waccsub->GetXaxis()->FindBin(140));
	TH1F * Pp188 = (TH1F *)Xipptheta188_waccsub->ProjectionY("Pp188",1,Xipptheta188_waccsub->GetXaxis()->FindBin(140));
	TH1F * Pp171MC = (TH1F *)Xipptheta171MC_waccsub->ProjectionY("Pp171MC",1,Xipptheta171MC_waccsub->GetXaxis()->FindBin(140));
	TH1F * Pp181MC = (TH1F *)Xipptheta181MC_waccsub->ProjectionY("Pp181MC",1,Xipptheta181MC_waccsub->GetXaxis()->FindBin(140));
	TH1F * Pp188MC = (TH1F *)Xipptheta188MC_waccsub->ProjectionY("Pp188MC",1,Xipptheta188MC_waccsub->GetXaxis()->FindBin(140));
	TH1F * Ptheta171 = (TH1F *)Xipptheta17_waccsub->ProjectionX("Ptheta171",1,Xipptheta17_waccsub->GetYaxis()->FindBin(10.));
	TH1F * Ptheta181 = (TH1F *)Xipptheta181_waccsub->ProjectionX("Ptheta181",1,Xipptheta181_waccsub->GetYaxis()->FindBin(10));
	TH1F * Ptheta188 = (TH1F *)Xipptheta188_waccsub->ProjectionX("Ptheta188",1,Xipptheta188_waccsub->GetYaxis()->FindBin(10));
	TH1F * Ptheta171MC = (TH1F *)Xipptheta171MC_waccsub->ProjectionX("Ptheta171MC",1,Xipptheta171MC_waccsub->GetYaxis()->FindBin(10));
	TH1F * Ptheta181MC = (TH1F *)Xipptheta181MC_waccsub->ProjectionX("Ptheta181MC",1,Xipptheta181MC_waccsub->GetYaxis()->FindBin(10));
	TH1F * Ptheta188MC = (TH1F *)Xipptheta188MC_waccsub->ProjectionX("Ptheta188MC",1,Xipptheta188MC_waccsub->GetYaxis()->FindBin(10));

	TH1F * pip171 = (TH1F *)Xipiptheta17_waccsub->ProjectionY("pip171",1,Xipiptheta17_waccsub->GetXaxis()->FindBin(140));
	TH1F * pip181 = (TH1F *)Xipiptheta181_waccsub->ProjectionY("pip181",1,Xipiptheta181_waccsub->GetXaxis()->FindBin(140));
	TH1F * pip188 = (TH1F *)Xipiptheta188_waccsub->ProjectionY("pip188",1,Xipiptheta188_waccsub->GetXaxis()->FindBin(140));
	TH1F * pip171MC = (TH1F *)Xipiptheta171MC_waccsub->ProjectionY("pip171MC",1,Xipiptheta171MC_waccsub->GetXaxis()->FindBin(140));
	TH1F * pip181MC = (TH1F *)Xipiptheta181MC_waccsub->ProjectionY("pip181MC",1,Xipiptheta181MC_waccsub->GetXaxis()->FindBin(140));
	TH1F * pip188MC = (TH1F *)Xipiptheta188MC_waccsub->ProjectionY("pip188MC",1,Xipiptheta188MC_waccsub->GetXaxis()->FindBin(140));
	TH1F * pitheta171 = (TH1F *)Xipiptheta17_waccsub->ProjectionX("pitheta171",1,Xipiptheta17_waccsub->GetYaxis()->FindBin(10.));
	TH1F * pitheta181 = (TH1F *)Xipiptheta181_waccsub->ProjectionX("pitheta181",1,Xipiptheta181_waccsub->GetYaxis()->FindBin(10));
	TH1F * pitheta188 = (TH1F *)Xipiptheta188_waccsub->ProjectionX("pitheta188",1,Xipiptheta188_waccsub->GetYaxis()->FindBin(10));
	TH1F * pitheta171MC = (TH1F *)Xipiptheta171MC_waccsub->ProjectionX("pitheta171MC",1,Xipiptheta171MC_waccsub->GetYaxis()->FindBin(10));
	TH1F * pitheta181MC = (TH1F *)Xipiptheta181MC_waccsub->ProjectionX("pitheta181MC",1,Xipiptheta181MC_waccsub->GetYaxis()->FindBin(10));
	TH1F * pitheta188MC = (TH1F *)Xipiptheta188MC_waccsub->ProjectionX("pitheta188MC",1,Xipiptheta188MC_waccsub->GetYaxis()->FindBin(10));

	TCanvas *ccXiKpMeasured = new TCanvas("ccXiKpMeasured", "ccXiKpMeasured", 800, 600);
	setformatTH1F(Kp171,color171,data);
	setformatTH1F(Kp181,color181,data);
	setformatTH1F(Kp188,color188,data);
	Kp188->Draw("pe");
	Kp171->Draw("pe,same"); 
	Kp181->Draw("pe,same");
	auto legend_sets = new TLegend(0.70,0.8,0.98,0.93);
	legend_sets->AddEntry(Kp171,"Spring 2017","lep");
	legend_sets->AddEntry(Kp181,"Spring 2018","lep");
	legend_sets->AddEntry(Kp188,"Fall 2018","lep");
	legend_sets->Draw();	
	ccXiKpMeasured->Print("Xi_K_p_measured_labframe_all_data.png");
	TCanvas *ccXiKpMeasuredMC = new TCanvas("ccXiKpMeasuredMC", "ccXiKpMeasuredMC", 800, 600);
	setformatTH1F(Kp171MC,color171,mc);
	setformatTH1F(Kp181MC,color181,mc);
	setformatTH1F(Kp188MC,color188,mc);
	Kp171MC->Draw("pe");
	Kp188MC->Draw("pe,same");
	Kp181MC->Draw("pe,same");
	auto legend_setsmc = new TLegend(0.70,0.8,0.98,0.93);
	legend_setsmc->AddEntry(Kp171MC,"Spring 2017 MC","lep");
	legend_setsmc->AddEntry(Kp181MC,"Spring 2018 MC","lep");
	legend_setsmc->AddEntry(Kp188MC,"Fall 2018 MC","lep");
	legend_setsmc->Draw();
	ccXiKpMeasuredMC->Print("Xi_K_p_measured_labframe_all_MC.png");

	TCanvas *ccXiKpMeasured_all = new TCanvas("ccXiKpMeasured_all", "ccXiKpMeasured_all", 800, 600);
	normalizeMC(Kp171, Kp171MC);
	normalizeMC(Kp181, Kp181MC);
	normalizeMC(Kp188, Kp188MC);
	Kp188->SetTitle("K^{+} Momentum");
	Kp188->Draw("pe");
	Kp171->Draw("pe,same"); 
	Kp181->Draw("pe,same");
	Kp171MC->Draw("pe,same");
	Kp188MC->Draw("pe,same");
	Kp181MC->Draw("pe,same");
	auto legend_all = new TLegend(0.70,0.7,0.98,0.93);
	legend_all->AddEntry(Kp171,"Spring 2017 Data","lep");
	legend_all->AddEntry(Kp181,"Spring 2018 Data","lep");
	legend_all->AddEntry(Kp188,"Fall 2018 Data","lep");
	legend_all->AddEntry(Kp171MC,"Spring 2017 MC","lep");
	legend_all->AddEntry(Kp181MC,"Spring 2018 MC","lep");
	legend_all->AddEntry(Kp188MC,"Fall 2018 MC","lep");
	legend_all->Draw();
	ccXiKpMeasured_all->Print("Xi_K_p_measured_labframe_allsets_june2020.png");


	TCanvas *ccXiKthetaMeasured = new TCanvas("ccXiKthetaMeasured", "ccXiKthetaMeasured", 800, 600);
	Ktheta188->SetLineColor(kBlue); Ktheta188->Draw();
	Ktheta171->SetLineColor(kGreen); Ktheta171->Draw("same"); 
	Ktheta181->SetLineColor(kRed); Ktheta181->Draw("same");
	legend_sets->Draw();
	ccXiKthetaMeasured->Print("Xi_K_theta_measured_labframe_all_data.png");
	TCanvas *ccXiKthetaMeasuredMC = new TCanvas("ccXiKthetaMeasuredMC", "ccXiKthetaMeasuredMC", 800, 600);
	Ktheta171MC->SetLineColor(kGreen); Ktheta171MC->Draw();
	Ktheta188MC->SetLineColor(kBlue); Ktheta188MC->Draw("same");
	Ktheta181MC->SetLineColor(kRed); Ktheta181MC->Draw("same");
	legend_sets->Draw();
	ccXiKthetaMeasuredMC->Print("Xi_K_theta_measured_labframe_all_MC.png");

	TCanvas *ccXiKthetaMeasured_all = new TCanvas("ccXiKthetaMeasured_all", "ccXiKthetaMeasured_all", 800, 600);
	setformatTH1F(Ktheta171,color171,data);
	setformatTH1F(Ktheta181,color181,data);
	setformatTH1F(Ktheta188,color188,data);
	setformatTH1F(Ktheta171MC,color171,mc);
	setformatTH1F(Ktheta181MC,color181,mc);
	setformatTH1F(Ktheta188MC,color188,mc);
	normalizeMC(Ktheta171,Ktheta171MC);
	normalizeMC(Ktheta181,Ktheta181MC);
	normalizeMC(Ktheta188,Ktheta188MC);
	Ktheta188MC->SetTitle("K^{+} Polar Angle");
	Ktheta188MC->GetXaxis()->SetTitle("#theta (deg)");
	Ktheta188MC->Draw("pe");
	Ktheta171->Draw("pe,same");
	Ktheta171MC->Draw("pe,same");
	Ktheta181->Draw("pe,same");
	Ktheta181MC->Draw("pe,same");
	Ktheta188->Draw("pe,same");
	legend_all->Draw();
	ccXiKthetaMeasured_all->Print("Xi_K_theta_measured_labframe_allsets_june2020.png");

	TCanvas *ccXiPpMeasured_all = new TCanvas("ccXiPpMeasured_all", "ccXiPpMeasured_all", 800, 600);
	setformatTH1F(Pp171,color171,data);
	setformatTH1F(Pp181,color181,data);
	setformatTH1F(Pp188,color188,data);
	setformatTH1F(Pp171MC,color171,mc);
	setformatTH1F(Pp181MC,color181,mc);
	setformatTH1F(Pp188MC,color188,mc);
	normalizeMC(Pp171,Pp171MC);
	normalizeMC(Pp181,Pp181MC);
	normalizeMC(Pp188,Pp188MC);
	Pp188->SetTitle("p Momentum");
	Pp188->GetXaxis()->SetTitle("p (GeV)");
	Pp188->Draw("pe");
	Pp171->Draw("pe,same");
	Pp171MC->Draw("pe,same");
	Pp181->Draw("pe,same");
	Pp181MC->Draw("pe,same");
	Pp188MC->Draw("pe,same");
	legend_all->Draw();
	ccXiPpMeasured_all->Print("Xi_p_p_measured_labframe_allsets_june2020.png");

	TCanvas *ccXiPthetaMeasured_all = new TCanvas("ccXiPthetaMeasured_all", "ccXiPthetaMeasured_all", 800, 600);
	setformatTH1F(Ptheta171,color171,data);
	setformatTH1F(Ptheta181,color181,data);
	setformatTH1F(Ptheta188,color188,data);
	setformatTH1F(Ptheta171MC,color171,mc);
	setformatTH1F(Ptheta181MC,color181,mc);
	setformatTH1F(Ptheta188MC,color188,mc);
	normalizeMC(Ptheta171,Ptheta171MC);
	normalizeMC(Ptheta181,Ptheta181MC);
	normalizeMC(Ptheta188,Ptheta188MC);
	Ptheta188MC->SetTitle("p Polar Angle");
	Ptheta188MC->GetXaxis()->SetTitle("#theta (deg)");
	Ptheta188MC->Draw("pe");
	Ptheta171->Draw("pe,same");
	Ptheta171MC->Draw("pe,same");
	Ptheta181->Draw("pe,same");
	Ptheta181MC->Draw("pe,same");
	Ptheta188->Draw("pe,same");
	legend_all->Draw();
	ccXiPthetaMeasured_all->Print("Xi_p_theta_measured_labframe_allsets_june2020.png");

	TCanvas *ccXipipMeasured_all = new TCanvas("ccXipipMeasured_all", "ccXipipMeasured_all", 800, 600);
	setformatTH1F(pip171,color171,data);
	setformatTH1F(pip181,color181,data);
	setformatTH1F(pip188,color188,data);
	setformatTH1F(pip171MC,color171,mc);
	setformatTH1F(pip181MC,color181,mc);
	setformatTH1F(pip188MC,color188,mc);
	normalizeMC(pip171,pip171MC);
	normalizeMC(pip181,pip181MC);
	normalizeMC(pip188,pip188MC);
	pip188MC->SetTitle("#pi^{-} Momentum");
	pip188MC->GetXaxis()->SetTitle("p (GeV)");
	pip188MC->Draw("pe");
	pip171->Draw("pe,same");
	pip171MC->Draw("pe,same");
	pip181->Draw("pe,same");
	pip181MC->Draw("pe,same");
	pip188->Draw("pe,same");
	legend_all->Draw();
	ccXipipMeasured_all->Print("Xi_pi_p_measured_labframe_allsets_june2020.png");

	TCanvas *ccXipithetaMeasured_all = new TCanvas("ccXipithetaMeasured_all", "ccXipithetaMeasured_all", 800, 600);
	setformatTH1F(pitheta171,color171,data);
	setformatTH1F(pitheta181,color181,data);
	setformatTH1F(pitheta188,color188,data);
	setformatTH1F(pitheta171MC,color171,mc);
	setformatTH1F(pitheta181MC,color181,mc);
	setformatTH1F(pitheta188MC,color188,mc);
	normalizeMC(pitheta171,pitheta171MC);
	normalizeMC(pitheta181,pitheta181MC);
	normalizeMC(pitheta188,pitheta188MC);
	pitheta188MC->SetTitle("#pi^{-} Polar Angle");
	pitheta188MC->GetXaxis()->SetTitle("#theta (deg)");
	pitheta188MC->Draw("pe");
	pitheta171->Draw("pe,same");
	pitheta171MC->Draw("pe,same");
	pitheta181->Draw("pe,same");
	pitheta181MC->Draw("pe,same");
	pitheta188->Draw("pe,same");
	legend_all->Draw();
	ccXipithetaMeasured_all->Print("Xi_pi_theta_measured_labframe_allsets_june2020.png");

	TCanvas *ccXiPpMeasured = new TCanvas("ccXiPpMeasured", "ccXiPpMeasured", 800, 600);
	Pp188->SetLineColor(kBlue); Pp188->Draw();
	Pp171->SetLineColor(kGreen); Pp171->Draw("same"); 
	Pp181->SetLineColor(kRed); Pp181->Draw("same");
	legend_sets->Draw();	
	ccXiPpMeasured->Print("Xi_p_p_measured_labframe_all_data.png");
	TCanvas *ccXiPpMeasuredMC = new TCanvas("ccXiPpMeasuredMC", "ccXiPpMeasuredMC", 800, 600);
	Pp171MC->SetLineColor(kGreen); Pp171MC->Draw();
	Pp188MC->SetLineColor(kBlue); Pp188MC->Draw("same");
	Pp181MC->SetLineColor(kRed); Pp181MC->Draw("same");
	legend_sets->Draw();
	ccXiPpMeasuredMC->Print("Xi_p_p_measured_labframe_all_MC.png");

	TCanvas *ccXiPthetaMeasured = new TCanvas("ccXiPthetaMeasured", "ccXiPthetaMeasured", 800, 600);
	Ptheta188->SetLineColor(kBlue); Ptheta188->Draw();
	Ptheta171->SetLineColor(kGreen); Ptheta171->Draw("same"); 
	Ptheta181->SetLineColor(kRed); Ptheta181->Draw("same");
	legend_sets->Draw();
	ccXiPthetaMeasured->Print("Xi_p_theta_measured_labframe_all_data.png");
	TCanvas *ccXiPthetaMeasuredMC = new TCanvas("ccXiPthetaMeasuredMC", "ccXiPthetaMeasuredMC", 800, 600);
	Ptheta171MC->SetLineColor(kGreen); Ptheta171MC->Draw();
	Ptheta188MC->SetLineColor(kBlue); Ptheta188MC->Draw("same");
	Ptheta181MC->SetLineColor(kRed); Ptheta181MC->Draw("same");
	legend_sets->Draw();
	ccXiPthetaMeasuredMC->Print("Xi_p_theta_measured_labframe_all_MC.png");

	TCanvas *ccXipipMeasured = new TCanvas("ccXipipMeasured", "ccXipipMeasured", 800, 600);
	pip188->SetLineColor(kBlue); pip188->Draw();
	pip171->SetLineColor(kGreen); pip171->Draw("same"); 
	pip181->SetLineColor(kRed); pip181->Draw("same");
	legend_sets->Draw();	
	ccXipipMeasured->Print("Xi_pi_p_measured_labframe_all_data.png");
	TCanvas *ccXipipMeasuredMC = new TCanvas("ccXipipMeasuredMC", "ccXipipMeasuredMC", 800, 600);
	pip171MC->SetLineColor(kGreen); pip171MC->Draw();
	pip188MC->SetLineColor(kBlue); pip188MC->Draw("same");
	pip181MC->SetLineColor(kRed); pip181MC->Draw("same");
	legend_sets->Draw();
	ccXipipMeasuredMC->Print("Xi_pi_p_measured_labframe_all_MC.png");

	TCanvas *ccXipithetaMeasured = new TCanvas("ccXipithetaMeasured", "ccXipithetaMeasured", 800, 600);
	pitheta188->SetLineColor(kBlue); pitheta188->Draw();
	pitheta171->SetLineColor(kGreen); pitheta171->Draw("same"); 
	pitheta181->SetLineColor(kRed); pitheta181->Draw("same");
	legend_sets->Draw();
	ccXipithetaMeasured->Print("Xi_pi_theta_measured_labframe_all_data.png");
	TCanvas *ccXipithetaMeasuredMC = new TCanvas("ccXipithetaMeasuredMC", "ccXipithetaMeasuredMC", 800, 600);
	pitheta171MC->SetLineColor(kGreen); pitheta171MC->Draw();
	pitheta188MC->SetLineColor(kBlue); pitheta188MC->Draw("same");
	pitheta181MC->SetLineColor(kRed); pitheta181MC->Draw("same");
	legend_sets->Draw();
	ccXipithetaMeasuredMC->Print("Xi_pi_theta_measured_labframe_all_MC.png");


	char XiMassMeasured17name[100];
	TCanvas *ccXiMassMeasured17 = new TCanvas("ccXiMassMeasured17", "ccXiMassMeasured17", 800, 600);
	TH1I * XiMassMeasured17 = (TH1I*)data201701->Get("XiMass");	
	TH1I * XiMassMeasured17_wacc = (TH1I*)data201701->Get("XiMass_wacc");
	TH1I *XiMassMeasured17_waccsub = (TH1I *) XiMassMeasured17->Clone("XiMassMeasured17_waccsub");
	XiMassMeasured17_waccsub->Add(XiMassMeasured17_wacc,-0.5);
	XiMassMeasured17_waccsub->RebinX(5);
	TH1I * XiMass17KinFit = (TH1I*)data201701->Get("XiMass_KinFit");
	TH1I * XiMass17KinFit_wacc = (TH1I*)data201701->Get("XiMass_KinFit_wacc");
	TH1I *XiMass17KinFit_waccsub = (TH1I *) XiMass17KinFit->Clone("XiMass17KinFit_waccsub");
	XiMass17KinFit_waccsub->Add(XiMass17KinFit_wacc,-0.5);
	XiMass17KinFit_waccsub->RebinX(5);
	setformatTH1I(XiMassMeasured17_waccsub,kRed,data);
	setformatTH1I(XiMass17KinFit_waccsub,kBlue,data);
	XiMassMeasured17_waccsub->GetYaxis()->SetRangeUser(0,2000);
	XiMassMeasured17_waccsub->SetTitle(" ");
	XiMassMeasured17_waccsub->GetXaxis()->SetTitle("#Lambda#pi^{-} Invariant Mass (GeV)");
	XiMassMeasured17_waccsub->GetYaxis()->SetTitle("Combos");
    XiMassMeasured17_waccsub->Draw("");
    XiMass17KinFit_waccsub->Draw("same");
	auto legend = new TLegend(0.70,0.8,0.98,0.93);
	legend->AddEntry(XiMassMeasured17_waccsub,"Measured P4","lep");
	legend->AddEntry(XiMass17KinFit_waccsub,"KinFit P4","lep");
	legend->Draw();
	sprintf(XiMassMeasured17name, "XiMass_measuredvskinfit_%s_data.png",version201701);
	ccXiMassMeasured17->Print(XiMassMeasured17name);

	char XiMassMeasured181name[100];
	TCanvas *ccXiMassMeasured181 = new TCanvas("ccXiMassMeasured181", "ccXiMassMeasured181", 800, 600);
	TH1I * XiMassMeasured181 = (TH1I*)data201801->Get("XiMass");	
	TH1I * XiMassMeasured181_wacc = (TH1I*)data201801->Get("XiMass_wacc");
	TH1I *XiMassMeasured181_waccsub = (TH1I *) XiMassMeasured181->Clone("XiMassMeasured181_waccsub");
	XiMassMeasured181_waccsub->Add(XiMassMeasured181_wacc,-0.5);
	XiMassMeasured181_waccsub->RebinX(5);
	TH1I * XiMass181KinFit = (TH1I*)data201801->Get("XiMass_KinFit");
	TH1I * XiMass181KinFit_wacc = (TH1I*)data201801->Get("XiMass_KinFit_wacc");
	TH1I *XiMass181KinFit_waccsub = (TH1I *) XiMass181KinFit->Clone("XiMass181KinFit_waccsub");
	XiMass181KinFit_waccsub->Add(XiMass181KinFit_wacc,-0.5);
	XiMass181KinFit_waccsub->RebinX(5);
	setformatTH1I(XiMassMeasured181_waccsub,kRed,data);
	setformatTH1I(XiMass181KinFit_waccsub,kBlue,data);
	XiMassMeasured181_waccsub->GetYaxis()->SetRangeUser(0,2500);
	XiMassMeasured181_waccsub->SetTitle(" ");
	XiMassMeasured181_waccsub->GetXaxis()->SetTitle("#Lambda#pi^{-} Invariant Mass (GeV)");
	XiMassMeasured181_waccsub->GetYaxis()->SetTitle("Combos");
    XiMassMeasured181_waccsub->Draw("");
    XiMass181KinFit_waccsub->Draw("same");
	legend->Draw();
	sprintf(XiMassMeasured181name, "XiMass_measuredvskinfit_%s_data.png",version201801);
	ccXiMassMeasured181->Print(XiMassMeasured181name);

	char XiMassMeasured188name[100];
	TCanvas *ccXiMassMeasured188 = new TCanvas("ccXiMassMeasured188", "ccXiMassMeasured188", 800, 600);
	TH1I * XiMassMeasured188 = (TH1I*)data201808->Get("XiMass");	
	TH1I * XiMassMeasured188_wacc = (TH1I*)data201808->Get("XiMass_wacc");
	TH1I *XiMassMeasured188_waccsub = (TH1I *) XiMassMeasured188->Clone("XiMassMeasured188_waccsub");
	XiMassMeasured188_waccsub->Add(XiMassMeasured188_wacc,-0.5);
	XiMassMeasured188_waccsub->RebinX(5);
	//TH1I * XiMassMeasured188_nan = (TH1I*)file4->Get("XiMass");	
	//TH1I * XiMassMeasured188_nan_wacc = (TH1I*)file4->Get("XiMass_wacc");
	//TH1I *XiMass188Measured_nan_waccsub = (TH1I *) XiMassMeasured188_nan->Clone("XiMass188Measured_nan_waccsub");
	//XiMass188Measured_nan_waccsub->Add(XiMassMeasured188_nan_wacc,-0.5);
	//XiMass188Measured_nan_waccsub->RebinX(5);
	TH1I * XiMass188KinFit = (TH1I*)data201808->Get("XiMass_KinFit");
	TH1I * XiMass188KinFit_wacc = (TH1I*)data201808->Get("XiMass_KinFit_wacc");
	TH1I *XiMass188KinFit_waccsub = (TH1I *) XiMass188KinFit->Clone("XiMass188KinFit_waccsub");
	XiMass188KinFit_waccsub->Add(XiMass188KinFit_wacc,-0.5);
	XiMass188KinFit_waccsub->RebinX(5);
	setformatTH1I(XiMass188KinFit_waccsub,kBlue,data);
	setformatTH1I(XiMassMeasured188_waccsub,kRed,data);
	//XiMass188Measured_nan_waccsub->SetLineColor(kGreen);
	XiMassMeasured188_waccsub->GetYaxis()->SetRangeUser(0,3750);
	XiMassMeasured188_waccsub->SetTitle(" ");
	XiMassMeasured188_waccsub->GetXaxis()->SetTitle("#Lambda#pi^{-} Invariant Mass (GeV)");
	XiMassMeasured188_waccsub->GetYaxis()->SetTitle("Combos");
    XiMassMeasured188_waccsub->Draw("");
    XiMass188KinFit_waccsub->Draw("same");
	//XiMass188Measured_nan_waccsub->Draw("same");
	auto legend_nonan = new TLegend(0.70,0.8,0.98,0.93);
	//legend_nonan->AddEntry(XiMass188Measured_nan_waccsub,"Measured P4 - NaN","l");
	legend_nonan->AddEntry(XiMassMeasured17_waccsub,"Measured P4","lep");
	legend_nonan->AddEntry(XiMass17KinFit_waccsub,"KinFit P4","lep");
	legend_nonan->Draw();
	sprintf(XiMassMeasured188name, "XiMass_measuredvskinfit_%s_data.png",version201808);
	ccXiMassMeasured188->Print(XiMassMeasured188name);

	char LambPathname[100];
	TCanvas *ccLambPath = new TCanvas("ccLambPath", "ccLambPath", 800, 600);
	TH1I * LambPath17 = (TH1I*)data201701->Get("LambPathLength_postCL");	
	TH1I * LambPath17_wacc = (TH1I*)data201701->Get("LambPathLength_postCL_wacc");
	TH1I * LambPath17_waccsub = (TH1I *) LambPath17->Clone("LambPath17_waccsub");
	LambPath17_waccsub->Add(LambPath17_wacc,-0.5);
	LambPath17_waccsub->Draw("e");
	LambPath17_waccsub->SetLineColor(kGreen);
	LambPath17_waccsub->SetMarkerStyle(21);
	LambPath17_waccsub->SetMarkerColor(kGreen);
	LambPath17_waccsub->SetMarkerSize(0.8);
	sprintf(LambPathname, "Xi_Lamb_PathLength_kinfit_labframe_%s_data.png",version201701);
	ccLambPath->Print(LambPathname);

	char VertZname171[100];
	TCanvas *ccVertZ171 = new TCanvas("ccVertZ171", "ccVertZ171", 800, 600);
	TH1I * ProdVertZ171 = (TH1I*)data201701->Get("ProdVert_postCL");	
	TH1I * XiVertZ171 = (TH1I*)data201701->Get("XiVert_postCL");	
	TH1I * LambVertZ171 = (TH1I*)data201701->Get("LambVert_postCL");
	ProdVertZ171->SetLineColor(kBlue);
	XiVertZ171->SetLineColor(kRed);
	LambVertZ171->SetLineColor(kGreen);
	ProdVertZ171->SetMarkerStyle(21);
	XiVertZ171->SetMarkerStyle(21);
	LambVertZ171->SetMarkerStyle(21);
	ProdVertZ171->SetMarkerColor(kBlue);
	XiVertZ171->SetMarkerColor(kRed);
	LambVertZ171->SetMarkerColor(kGreen);
	ProdVertZ171->SetMarkerSize(0.8);
	XiVertZ171->SetMarkerSize(0.8);
	LambVertZ171->SetMarkerSize(0.8);
	ProdVertZ171->SetTitle(" ");
	ProdVertZ171->GetXaxis()->SetTitle("Vertex Z (cm)");
	ProdVertZ171->GetYaxis()->SetTitle("Combos");
	ProdVertZ171->GetXaxis()->SetRangeUser(25,200);
	ProdVertZ171->Draw("e");
	XiVertZ171->Draw("e,same");
	LambVertZ171->Draw("e,same");
	auto legend_vert = new TLegend(0.70,0.8,0.98,0.93);
	legend_vert->AddEntry(ProdVertZ171,"Production Vertex","lep");
	legend_vert->AddEntry(XiVertZ171,"Xi- Vertex","lep");
	legend_vert->AddEntry(LambVertZ171,"Lambda Vertex","lep");
	legend_vert->Draw();
	sprintf(VertZname171, "VertZ__%s.png",version201701);
	ccVertZ171->Print(VertZname171);

	char VertZname181[100];
	TCanvas *ccVertZ181 = new TCanvas("ccVertZ181", "ccVertZ181", 800, 600);
	TH1I * ProdVertZ181 = (TH1I*)data201801->Get("ProdVert_postCL");	
	TH1I * XiVertZ181 = (TH1I*)data201801->Get("XiVert_postCL");	
	TH1I * LambVertZ181 = (TH1I*)data201801->Get("LambVert_postCL");
	ProdVertZ181->SetLineColor(kBlue);
	XiVertZ181->SetLineColor(kRed);
	LambVertZ181->SetLineColor(kGreen);
	ProdVertZ181->SetMarkerStyle(21);
	XiVertZ181->SetMarkerStyle(21);
	LambVertZ181->SetMarkerStyle(21);
	ProdVertZ181->SetMarkerColor(kBlue);
	XiVertZ181->SetMarkerColor(kRed);
	LambVertZ181->SetMarkerColor(kGreen);
	ProdVertZ181->SetMarkerSize(0.8);
	XiVertZ181->SetMarkerSize(0.8);
	LambVertZ181->SetMarkerSize(0.8);
	ProdVertZ181->SetTitle(" ");
	ProdVertZ181->GetXaxis()->SetTitle("Vertex Z (cm)");
	ProdVertZ181->GetYaxis()->SetTitle("Combos");
	ProdVertZ181->GetXaxis()->SetRangeUser(25,200);
	ProdVertZ181->Draw("e");
	XiVertZ181->Draw("e,same");
	LambVertZ181->Draw("e,same");
	legend_vert->Draw();
	sprintf(VertZname181, "VertZ_%s.png",version201801);
	ccVertZ181->Print(VertZname181);

	char VertZname188[100];
	TCanvas *ccVertZ188 = new TCanvas("ccVertZ188", "ccVertZ188", 800, 600);
	TH1I * ProdVertZ188 = (TH1I*)data201808->Get("ProdVert_postCL");	
	TH1I * XiVertZ188 = (TH1I*)data201808->Get("XiVert_postCL");	
	TH1I * LambVertZ188 = (TH1I*)data201808->Get("LambVert_postCL");
	ProdVertZ188->SetLineColor(kBlue);
	XiVertZ188->SetLineColor(kRed);
	LambVertZ188->SetLineColor(kGreen);
	ProdVertZ188->SetMarkerStyle(21);
	XiVertZ188->SetMarkerStyle(21);
	LambVertZ188->SetMarkerStyle(21);
	ProdVertZ188->SetMarkerColor(kBlue);
	XiVertZ188->SetMarkerColor(kRed);
	LambVertZ188->SetMarkerColor(kGreen);
	ProdVertZ188->SetMarkerSize(0.8);
	XiVertZ188->SetMarkerSize(0.8);
	LambVertZ188->SetMarkerSize(0.8);
	ProdVertZ188->SetTitle(" ");
	ProdVertZ188->GetXaxis()->SetTitle("Vertex Z (cm)");
	ProdVertZ188->GetYaxis()->SetTitle("Combos");
	ProdVertZ188->GetXaxis()->SetRangeUser(25,200);
	ProdVertZ188->Draw("e");
	XiVertZ188->Draw("e,same");
	LambVertZ188->Draw("e,same");
	legend_vert->Draw();
	sprintf(VertZname188, "VertZ_%s.png",version201808);
	ccVertZ188->Print(VertZname188);

	char VertZname171MC[100];
	TCanvas *ccVertZ171MC = new TCanvas("ccVertZ171MC", "ccVertZ171MC", 800, 600);
	TH1I * ProdVertZ171MC = (TH1I*)mc201701->Get("ProdVert_postCL");	
	TH1I * XiVertZ171MC = (TH1I*)mc201701->Get("XiVert_postCL");	
	TH1I * LambVertZ171MC = (TH1I*)mc201701->Get("LambVert_postCL");
	ProdVertZ171MC->SetLineColor(kBlue);
	XiVertZ171MC->SetLineColor(kRed);
	LambVertZ171MC->SetLineColor(kGreen);
	ProdVertZ171MC->SetMarkerStyle(21);
	XiVertZ171MC->SetMarkerStyle(21);
	LambVertZ171MC->SetMarkerStyle(21);
	ProdVertZ171MC->SetMarkerColor(kBlue);
	XiVertZ171MC->SetMarkerColor(kRed);
	LambVertZ171MC->SetMarkerColor(kGreen);
	ProdVertZ171MC->SetMarkerSize(0.8);
	XiVertZ171MC->SetMarkerSize(0.8);
	LambVertZ171MC->SetMarkerSize(0.8);
	ProdVertZ171MC->SetTitle(" ");
	ProdVertZ171MC->GetXaxis()->SetTitle("Vertex Z (cm)");
	ProdVertZ171MC->GetYaxis()->SetTitle("Combos");
	ProdVertZ171MC->Draw("e");
	XiVertZ171MC->Draw("e,same");
	LambVertZ171MC->Draw("e,same");
	legend_vert->Draw();
	sprintf(VertZname171MC, "VertZ_MC_%s.png",version201701);
	ccVertZ171MC->Print(VertZname171MC);

	char VertZname181MC[100];
	TCanvas *ccVertZ181MC = new TCanvas("ccVertZ181MC", "ccVertZ181MC", 800, 600);
	TH1I * ProdVertZ181MC = (TH1I*)mc201801->Get("ProdVert_postCL");	
	TH1I * XiVertZ181MC = (TH1I*)mc201801->Get("XiVert_postCL");	
	TH1I * LambVertZ181MC = (TH1I*)mc201801->Get("LambVert_postCL");
	ProdVertZ181MC->SetLineColor(kBlue);
	XiVertZ181MC->SetLineColor(kRed);
	LambVertZ181MC->SetLineColor(kGreen);
	ProdVertZ181MC->SetMarkerStyle(21);
	XiVertZ181MC->SetMarkerStyle(21);
	LambVertZ181MC->SetMarkerStyle(21);
	ProdVertZ181MC->SetMarkerColor(kBlue);
	XiVertZ181MC->SetMarkerColor(kRed);
	LambVertZ181MC->SetMarkerColor(kGreen);
	ProdVertZ181MC->SetMarkerSize(0.8);
	XiVertZ181MC->SetMarkerSize(0.8);
	LambVertZ181MC->SetMarkerSize(0.8);
	ProdVertZ181MC->SetTitle(" ");
	ProdVertZ181MC->GetXaxis()->SetTitle("Vertex Z (cm)");
	ProdVertZ181MC->GetYaxis()->SetTitle("Combos");
	ProdVertZ181MC->Draw("e");
	XiVertZ181MC->Draw("e,same");
	LambVertZ181MC->Draw("e,same");
	legend_vert->Draw();
	sprintf(VertZname181MC, "VertZ_MC_%s.png",version201801);
	ccVertZ181MC->Print(VertZname181MC);

	char VertZname188MC[100];
	TCanvas *ccVertZ188MC = new TCanvas("ccVertZ188MC", "ccVertZ188MC", 800, 600);
	TH1I * ProdVertZ188MC = (TH1I*)mc201808->Get("ProdVert_postCL");	
	TH1I * XiVertZ188MC = (TH1I*)mc201808->Get("XiVert_postCL");	
	TH1I * LambVertZ188MC = (TH1I*)mc201808->Get("LambVert_postCL");
	ProdVertZ188MC->SetLineColor(kBlue);
	XiVertZ188MC->SetLineColor(kRed);
	LambVertZ188MC->SetLineColor(kGreen);
	ProdVertZ188MC->SetMarkerStyle(21);
	XiVertZ188MC->SetMarkerStyle(21);
	LambVertZ188MC->SetMarkerStyle(21);
	ProdVertZ188MC->SetMarkerColor(kBlue);
	XiVertZ188MC->SetMarkerColor(kRed);
	LambVertZ188MC->SetMarkerColor(kGreen);
	ProdVertZ188MC->SetMarkerSize(0.8);
	XiVertZ188MC->SetMarkerSize(0.8);
	LambVertZ188MC->SetMarkerSize(0.8);
	ProdVertZ188MC->SetTitle(" ");
	ProdVertZ188MC->GetXaxis()->SetTitle("Vertex Z (cm)");
	ProdVertZ188MC->GetYaxis()->SetTitle("Combos");
	ProdVertZ188MC->Draw("e");
	XiVertZ188MC->Draw("e,same");
	LambVertZ188MC->Draw("e,same");
	legend_vert->Draw();
	sprintf(VertZname188MC, "VertZ_MC_%s.png",version201808);
	ccVertZ188MC->Print(VertZname188MC);

	char CLname[100];
	TCanvas *ccCL = new TCanvas("ccCL", "ccCL", 800, 600);
	TH1I * CL171 = (TH1I*)data201701->Get("Hist_KinFitResults/ConfidenceLevel");	
	TH1I * CL181 = (TH1I*)data201801->Get("Hist_KinFitResults/ConfidenceLevel");	
	TH1I * CL188 = (TH1I*)data201808->Get("Hist_KinFitResults/ConfidenceLevel");	
	CL171->SetLineColor(kGreen);
	CL181->SetLineColor(kRed);
	CL188->SetLineColor(kBlue);	
	CL171->Draw();
	CL181->Draw("same");
	CL188->Draw("same");
	legend_sets->Draw();
	ccCL->SetLogy();
	sprintf(CLname, "CL_logy.png");
	ccCL->Print(CLname);

	char ChiSqname[100];
	TCanvas *ccChiSq = new TCanvas("ccChiSq", "ccChiSq", 800, 600);
	TH1I * ChiSq171 = (TH1I*)data201701->Get("Hist_KinFitResults/ChiSqPerDF");	
	TH1I * ChiSq181 = (TH1I*)data201801->Get("Hist_KinFitResults/ChiSqPerDF");	
	TH1I * ChiSq188 = (TH1I*)data201808->Get("Hist_KinFitResults/ChiSqPerDF");
	ChiSq171->SetLineColor(kGreen);
	ChiSq181->SetLineColor(kRed);
	ChiSq188->SetLineColor(kBlue);	
	ChiSq171->GetYaxis()->SetRangeUser(0,50000);
	ChiSq171->Draw();
	ChiSq181->Draw("same");
	ChiSq188->Draw("same");
	legend_sets->Draw();
	sprintf(ChiSqname, "ChiSq.png");
	ccChiSq->Print(ChiSqname);

	char ChiSqXiname[100];
	TCanvas *ccChiSqXi = new TCanvas("ccChiSqXi", "ccChiSqXi", 800, 600);
	TH2I * ChiSqXi171 = (TH2I*)data201701->Get("ChiSqXi_KinFit");	
	TH2I * ChiSqXi181 = (TH2I*)data201801->Get("ChiSqXi_KinFit");	
	TH2I * ChiSqXi188 = (TH2I*)data201808->Get("ChiSqXi_KinFit");
	TH2I * ChiSqXi171_wacc = (TH2I*)data201701->Get("ChiSqXi_KinFit_wacc");	
	TH2I * ChiSqXi181_wacc = (TH2I*)data201801->Get("ChiSqXi_KinFit_wacc");	
	TH2I * ChiSqXi188_wacc = (TH2I*)data201808->Get("ChiSqXi_KinFit_wacc");
	TH2I * ChiSqXi171_waccsub = (TH2I *) ChiSqXi171->Clone("ChiSqXi171_waccsub");
	TH2I * ChiSqXi181_waccsub = (TH2I *) ChiSqXi181->Clone("ChiSqXi181_waccsub");
	TH2I * ChiSqXi188_waccsub = (TH2I *) ChiSqXi188->Clone("ChiSqXi188_waccsub");
	ChiSqXi171_waccsub->Add(ChiSqXi171_wacc,-0.5);
	ChiSqXi181_waccsub->Add(ChiSqXi181_wacc,-0.5);
	ChiSqXi188_waccsub->Add(ChiSqXi188_wacc,-0.5);
	TH1I * Xi_ChiSqXi171_waccsub = (TH1I *)ChiSqXi171_waccsub->ProjectionX("Xi_ChiSqXi171_waccsub",ChiSqXi171_waccsub->GetYaxis()->FindBin(1.31),ChiSqXi171_waccsub->GetYaxis()->FindBin(1.34));
	TH1I * Xi_ChiSqXi181_waccsub = (TH1I *)ChiSqXi181_waccsub->ProjectionX("Xi_ChiSqXi181_waccsub",ChiSqXi181_waccsub->GetYaxis()->FindBin(1.31),ChiSqXi181_waccsub->GetYaxis()->FindBin(1.34));
	TH1I * Xi_ChiSqXi188_waccsub = (TH1I *)ChiSqXi188_waccsub->ProjectionX("Xi_ChiSqXi188_waccsub",ChiSqXi188_waccsub->GetYaxis()->FindBin(1.31),ChiSqXi188_waccsub->GetYaxis()->FindBin(1.34));
	Xi_ChiSqXi171_waccsub->GetXaxis()->SetRangeUser(0,15);
	Xi_ChiSqXi181_waccsub->GetXaxis()->SetRangeUser(0,15);
	Xi_ChiSqXi188_waccsub->GetXaxis()->SetRangeUser(0,15);
	Xi_ChiSqXi171_waccsub->SetLineColor(kGreen);
	Xi_ChiSqXi181_waccsub->SetLineColor(kRed);
	Xi_ChiSqXi188_waccsub->SetLineColor(kBlue);	
	Xi_ChiSqXi171_waccsub->GetYaxis()->SetRangeUser(0,2000);
	Xi_ChiSqXi171_waccsub->Draw();
	Xi_ChiSqXi181_waccsub->Draw("same");
	Xi_ChiSqXi188_waccsub->Draw("same");
	legend_sets->Draw();
	sprintf(ChiSqXiname, "ChiSqXi.png");
	ccChiSqXi->Print(ChiSqXiname);

	char ChiSqVsXiname[100];
	TCanvas *ccChiSqVsXi171 = new TCanvas("ccChiSqVsXi171", "ccChiSqVsXi171", 800, 600);
	ChiSqXi171_waccsub->GetXaxis()->SetRangeUser(0,15);
	TLine *lineChi = new TLine(3.5,1.1,3.5,1.5);
	lineChi->SetLineColor(kRed);
	TArrow *arrowChi = new TArrow(3.5,1.47,2.5,1.47,0.01,"|>");
	arrowChi->SetLineColor(kRed);
	arrowChi->SetFillColor(kRed);
	arrowChi->SetLineWidth(2);
	lineChi->SetLineWidth(2);
	ChiSqXi171_waccsub->Draw("colz");
	lineChi->Draw("Same");
	arrowChi->DrawArrow(3.5,1.47,2.5,1.47,0.01,"|>");
	sprintf(ChiSqVsXiname, "ChiSqVsXi_%s.png",version201701);
	ccChiSqVsXi171->Print(ChiSqVsXiname);
	TCanvas *ccChiSqVsXi181 = new TCanvas("ccChiSqVsXi181", "ccChiSqVsXi181", 800, 600);
	ChiSqXi181_waccsub->GetXaxis()->SetRangeUser(0,15);
	ChiSqXi181_waccsub->Draw("colz");
	lineChi->Draw("Same");
	arrowChi->DrawArrow(3.5,1.47,2.5,1.47,0.01,"|>");
	sprintf(ChiSqVsXiname, "ChiSqVsXi_%s.png",version201801);
	ccChiSqVsXi181->Print(ChiSqVsXiname);
	TCanvas *ccChiSqVsXi188 = new TCanvas("ccChiSqVsXi188", "ccChiSqVsXi188", 800, 600);
	ChiSqXi188_waccsub->GetXaxis()->SetRangeUser(0,15);
	ChiSqXi188_waccsub->Draw("colz");
	lineChi->Draw("Same");
	arrowChi->DrawArrow(3.5,1.47,2.5,1.47,0.01,"|>");
	sprintf(ChiSqVsXiname, "ChiSqVsXi_%s.png",version201808);
	ccChiSqVsXi188->Print(ChiSqVsXiname);

	char ChiSqXiMCname[100];
	TCanvas *ccChiSqXiMC = new TCanvas("ccChiSqXiMC", "ccChiSqXiMC", 800, 600);
	TH2I * ChiSqXiMC171 = (TH2I*)mc201701->Get("ChiSqXi_KinFit");	
	TH2I * ChiSqXiMC181 = (TH2I*)mc201801->Get("ChiSqXi_KinFit");	
	TH2I * ChiSqXiMC188 = (TH2I*)mc201808->Get("ChiSqXi_KinFit");
	TH2I * ChiSqXiMC171_wacc = (TH2I*)mc201701->Get("ChiSqXi_KinFit_wacc");	
	TH2I * ChiSqXiMC181_wacc = (TH2I*)mc201801->Get("ChiSqXi_KinFit_wacc");	
	TH2I * ChiSqXiMC188_wacc = (TH2I*)mc201808->Get("ChiSqXi_KinFit_wacc");
	TH2I * ChiSqXiMC171_waccsub = (TH2I *) ChiSqXiMC171->Clone("ChiSqXiMC171_waccsub");
	TH2I * ChiSqXiMC181_waccsub = (TH2I *) ChiSqXiMC181->Clone("ChiSqXiMC181_waccsub");
	TH2I * ChiSqXiMC188_waccsub = (TH2I *) ChiSqXiMC188->Clone("ChiSqXiMC188_waccsub");
	ChiSqXiMC171_waccsub->Add(ChiSqXiMC171_wacc,-0.5);
	ChiSqXiMC181_waccsub->Add(ChiSqXiMC181_wacc,-0.5);
	ChiSqXiMC188_waccsub->Add(ChiSqXiMC188_wacc,-0.5);
	TH1I * Xi_ChiSqXiMC171_waccsub = (TH1I *)ChiSqXiMC171_waccsub->ProjectionX("Xi_ChiSqXiMC171_waccsub",ChiSqXiMC171_waccsub->GetYaxis()->FindBin(1.31),ChiSqXiMC171_waccsub->GetYaxis()->FindBin(1.34));
	TH1I * Xi_ChiSqXiMC181_waccsub = (TH1I *)ChiSqXiMC181_waccsub->ProjectionX("Xi_ChiSqXiMC181_waccsub",ChiSqXiMC181_waccsub->GetYaxis()->FindBin(1.31),ChiSqXiMC181_waccsub->GetYaxis()->FindBin(1.34));
	TH1I * Xi_ChiSqXiMC188_waccsub = (TH1I *)ChiSqXiMC188_waccsub->ProjectionX("Xi_ChiSqXiMC188_waccsub",ChiSqXiMC188_waccsub->GetYaxis()->FindBin(1.31),ChiSqXiMC188_waccsub->GetYaxis()->FindBin(1.34));
	Xi_ChiSqXiMC171_waccsub->GetXaxis()->SetRangeUser(0,15);
	Xi_ChiSqXiMC181_waccsub->GetXaxis()->SetRangeUser(0,15);
	Xi_ChiSqXiMC188_waccsub->GetXaxis()->SetRangeUser(0,15);
	Xi_ChiSqXiMC171_waccsub->SetLineColor(kGreen);
	Xi_ChiSqXiMC181_waccsub->SetLineColor(kRed);
	Xi_ChiSqXiMC188_waccsub->SetLineColor(kBlue);	
	Xi_ChiSqXiMC171_waccsub->GetYaxis()->SetRangeUser(0,4000);
	Xi_ChiSqXiMC171_waccsub->Draw();
	Xi_ChiSqXiMC181_waccsub->Draw("same");
	Xi_ChiSqXiMC188_waccsub->Draw("same");
	legend_sets->Draw();
	sprintf(ChiSqXiMCname, "ChiSqXiMC.png");
	ccChiSqXiMC->Print(ChiSqXiMCname);

	TCanvas *ccChiSqAll = new TCanvas("ccChiSqAll", "ccChiSqAll",800,600);
	Xi_ChiSqXi171_waccsub->SetMarkerStyle(20);
	Xi_ChiSqXi181_waccsub->SetMarkerStyle(20);
	Xi_ChiSqXi188_waccsub->SetMarkerStyle(20);
	Xi_ChiSqXiMC171_waccsub->SetMarkerStyle(25);
	Xi_ChiSqXiMC181_waccsub->SetMarkerStyle(25);
	Xi_ChiSqXiMC188_waccsub->SetMarkerStyle(25);
	Xi_ChiSqXi171_waccsub->SetMarkerSize(0.8);
	Xi_ChiSqXi181_waccsub->SetMarkerSize(0.8);
	Xi_ChiSqXi188_waccsub->SetMarkerSize(0.8);
	Xi_ChiSqXiMC171_waccsub->SetMarkerSize(0.8);
	Xi_ChiSqXiMC181_waccsub->SetMarkerSize(0.8);
	Xi_ChiSqXiMC188_waccsub->SetMarkerSize(0.8);
	Xi_ChiSqXi171_waccsub->SetMarkerColor(kGreen);
	Xi_ChiSqXi181_waccsub->SetMarkerColor(kRed);
	Xi_ChiSqXi188_waccsub->SetMarkerColor(kBlue);
	Xi_ChiSqXiMC171_waccsub->SetMarkerColor(kGreen);
	Xi_ChiSqXiMC181_waccsub->SetMarkerColor(kRed);
	Xi_ChiSqXiMC188_waccsub->SetMarkerColor(kBlue);
	Xi_ChiSqXi171_waccsub->Draw("pe");
	Xi_ChiSqXi181_waccsub->Draw("pe,same");
	Xi_ChiSqXi188_waccsub->Draw("pe,same");
	Xi_ChiSqXiMC171_waccsub->Draw("pe,same");
	Xi_ChiSqXiMC181_waccsub->Draw("pe,same");
	Xi_ChiSqXiMC188_waccsub->Draw("pe,same");
	Xi_ChiSqXi171_waccsub->GetYaxis()->SetRangeUser(0,4000);
	auto legend_chisqall = new TLegend(0.70,0.7,0.98,0.93);
	legend_chisqall->AddEntry(Xi_ChiSqXi171_waccsub,"Spring 2017 Data","lep");
	legend_chisqall->AddEntry(Xi_ChiSqXi181_waccsub,"Spring 2018 Data","lep");
	legend_chisqall->AddEntry(Xi_ChiSqXi188_waccsub,"Fall 2018 Data","lep");
	legend_chisqall->AddEntry(Xi_ChiSqXiMC171_waccsub,"Spring 2017 MC","lep");
	legend_chisqall->AddEntry(Xi_ChiSqXiMC181_waccsub,"Spring 2018 MC","lep");
	legend_chisqall->AddEntry(Xi_ChiSqXiMC188_waccsub,"Fall 2018 MC","lep");
	legend_chisqall->Draw();
	ccChiSqAll->Print("ChiSq_Xi_allsets.png");	

	char CLMCname[100];
	TCanvas *ccCLMC = new TCanvas("ccCLMC", "ccCLMC", 800, 600);
	TH1I * CLMC171 = (TH1I*)mc201701->Get("Hist_KinFitResults/ConfidenceLevel");	
	TH1I * CLMC181 = (TH1I*)mc201801->Get("Hist_KinFitResults/ConfidenceLevel");	
	TH1I * CLMC188 = (TH1I*)mc201808->Get("Hist_KinFitResults/ConfidenceLevel");	
	double norm201701 = CLMC171->GetEntries();
	double norm201801 = CLMC181->GetEntries();
	double norm201808 = CLMC188->GetEntries();
	CLMC171->SetLineColor(kGreen);
	CLMC181->SetLineColor(kRed);
	CLMC188->SetLineColor(kBlue);
	CLMC171->Scale(norm201808/norm201701);  
	CLMC181->Scale(norm201801/norm201801);  
	CLMC188->Scale(norm201808/norm201808);  	
	CLMC171->Draw();
	CLMC181->Draw("same");
	CLMC188->Draw("same");
	legend_sets->Draw();
	ccCLMC->SetLogy();
	sprintf(CLMCname, "CLMC_logy.png");
	ccCLMC->Print(CLMCname);

	char ChiSqMCname[100];
	TCanvas *ccChiSqMC = new TCanvas("ccChiSqMC", "ccChiSqMC", 800, 600);
	TH1I * ChiSqMC171 = (TH1I*)mc201701->Get("Hist_KinFitResults/ChiSqPerDF");	
	TH1I * ChiSqMC181 = (TH1I*)mc201801->Get("Hist_KinFitResults/ChiSqPerDF");	
	TH1I * ChiSqMC188 = (TH1I*)mc201808->Get("Hist_KinFitResults/ChiSqPerDF");	
	ChiSqMC171->SetLineColor(kGreen);
	ChiSqMC181->SetLineColor(kRed);
	ChiSqMC188->SetLineColor(kBlue);	
	ChiSqMC171->Scale(norm201808/norm201701);
	ChiSqMC181->Scale(norm201801/norm201801); 
	ChiSqMC188->Scale(norm201808/norm201808); 
	ChiSqMC171->GetYaxis()->SetRangeUser(0,40000);
	ChiSqMC171->Draw();
	ChiSqMC181->Draw("same");
	ChiSqMC188->Draw("same");
	legend_sets->Draw();
	sprintf(ChiSqMCname, "ChiSqMC.png");
	ccChiSqMC->Print(ChiSqMCname);

	char Ystarname[100];
	TCanvas *ccYstar = new TCanvas("ccYstar", "ccYstar", 800, 600);
 	TH1I * Ystar171 = (TH1I*)data201701->Get("KlowpXim");
	TH1I * Ystar171_wacc = (TH1I*)data201701->Get("KlowpXim_wacc");
	TH1I * Ystar171_waccsub = (TH1I *) Ystar171->Clone("Ystar171_waccsub");
	Ystar171_waccsub->Add(Ystar171_wacc,-0.5);
 	TH1I * Ystar181 = (TH1I*)data201801->Get("KlowpXim");
	TH1I * Ystar181_wacc = (TH1I*)data201801->Get("KlowpXim_wacc");
	TH1I * Ystar181_waccsub = (TH1I *) Ystar181->Clone("Ystar181_waccsub");
	Ystar181_waccsub->Add(Ystar181_wacc,-0.5);
 	TH1I * Ystar188 = (TH1I*)data201808->Get("KlowpXim");
	TH1I * Ystar188_wacc = (TH1I*)data201808->Get("KlowpXim_wacc");
	TH1I * Ystar188_waccsub = (TH1I *) Ystar188->Clone("Ystar188_waccsub");
	Ystar188_waccsub->Add(Ystar188_wacc,-0.5);
	Ystar171->RebinX(3);
	Ystar181->RebinX(3);
	Ystar188->RebinX(3);
	setformatTH1I(Ystar171,color171,data); 
	setformatTH1I(Ystar181,color181,data);
	setformatTH1I(Ystar188,color188,data);
	Ystar188->SetTitle("");
	Ystar188->GetYaxis()->SetTitle("Combos");
	Ystar188->GetYaxis()->SetTitleOffset(1.5);
	Ystar188->Draw("pe");
	Ystar181->Draw("pe,same");
	Ystar171->Draw("pe,same");
	legend_sets->Draw();
	sprintf(Ystarname,"Ystar.png");
	ccYstar->Print(Ystarname);

	char tdistname[100];
	TCanvas *cctdist = new TCanvas("cctdist", "cctdist", 800, 600);
 	TH2F * XiMassKinFit_Egamma_t171 = (TH2F*)data201701->Get("Xi_t");
	TH2F * XiMassKinFit_Egamma_t171_wacc = (TH2F*)data201701->Get("Xi_t_wacc");
	TH2F * XiMassKinFit_Egamma_t171_waccsub = (TH2F *) XiMassKinFit_Egamma_t171->Clone("XiMassKinFit_Egamma_t171_waccsub");
	XiMassKinFit_Egamma_t171_waccsub->Add(XiMassKinFit_Egamma_t171_wacc,-0.5);
	TH1F * t171 = (TH1F *)XiMassKinFit_Egamma_t171_waccsub->ProjectionY("t171",XiMassKinFit_Egamma_t171_waccsub->GetXaxis()->FindBin(1.31),XiMassKinFit_Egamma_t171_waccsub->GetXaxis()->FindBin(1.34));
 	TH2F * XiMassKinFit_Egamma_t181 = (TH2F*)data201801->Get("Xi_t");
	TH2F * XiMassKinFit_Egamma_t181_wacc = (TH2F*)data201801->Get("Xi_t_wacc");
	TH2F * XiMassKinFit_Egamma_t181_waccsub = (TH2F *) XiMassKinFit_Egamma_t181->Clone("XiMassKinFit_Egamma_t181_waccsub");
	XiMassKinFit_Egamma_t181_waccsub->Add(XiMassKinFit_Egamma_t181_wacc,-0.5);
	TH1F * t181 = (TH1F *)XiMassKinFit_Egamma_t181_waccsub->ProjectionY("t181",XiMassKinFit_Egamma_t181_waccsub->GetXaxis()->FindBin(1.31),XiMassKinFit_Egamma_t181_waccsub->GetXaxis()->FindBin(1.34));
 	TH2F * XiMassKinFit_Egamma_t188 = (TH2F*)data201808->Get("Xi_t");
	TH2F * XiMassKinFit_Egamma_t188_wacc = (TH2F*)data201808->Get("Xi_t_wacc");
	TH2F * XiMassKinFit_Egamma_t188_waccsub = (TH2F *) XiMassKinFit_Egamma_t188->Clone("XiMassKinFit_Egamma_t188_waccsub");
	XiMassKinFit_Egamma_t188_waccsub->Add(XiMassKinFit_Egamma_t188_wacc,-0.5);
	TH1F * t188 = (TH1F *)XiMassKinFit_Egamma_t188_waccsub->ProjectionY("t188",XiMassKinFit_Egamma_t188_waccsub->GetXaxis()->FindBin(1.31),XiMassKinFit_Egamma_t188_waccsub->GetXaxis()->FindBin(1.34));
	t171->RebinX(5);
	t181->RebinX(5);
	t188->RebinX(5);
	setformatTH1F(t171,color171,data); 
	setformatTH1F(t181,color181,data);
	setformatTH1F(t188,color188,data);
	t188->SetTitle("");
	t188->GetYaxis()->SetTitle("Combos");
	t188->GetYaxis()->SetTitleOffset(1.5);
	t188->Draw();
	t181->Draw("same");
	t171->Draw("same");
	legend_sets->Draw();
	sprintf(tdistname,"tdist.png");
	cctdist->Print(tdistname);

	char tdistMCname[100];
	TCanvas *cctdistMC = new TCanvas("cctdistMC", "cctdistMC", 800, 600);
 	TH2F * XiMassKinFit_Egamma_t171MC = (TH2F*)mc201701->Get("Xi_t");
	TH2F * XiMassKinFit_Egamma_t171MC_wacc = (TH2F*)mc201701->Get("Xi_t_wacc");
	TH2F * XiMassKinFit_Egamma_t171MC_waccsub = (TH2F *) XiMassKinFit_Egamma_t171MC->Clone("XiMassKinFit_Egamma_t171MC_waccsub");
	XiMassKinFit_Egamma_t171MC_waccsub->Add(XiMassKinFit_Egamma_t171MC_wacc,-0.5);
	TH1F * t171MC = (TH1F *)XiMassKinFit_Egamma_t171MC_waccsub->ProjectionY("t171MC",XiMassKinFit_Egamma_t171MC_waccsub->GetXaxis()->FindBin(1.31),XiMassKinFit_Egamma_t171MC_waccsub->GetXaxis()->FindBin(1.34));
 	TH2F * XiMassKinFit_Egamma_t181MC = (TH2F*)mc201801->Get("Xi_t");
	TH2F * XiMassKinFit_Egamma_t181MC_wacc = (TH2F*)mc201801->Get("Xi_t_wacc");
	TH2F * XiMassKinFit_Egamma_t181MC_waccsub = (TH2F *) XiMassKinFit_Egamma_t181MC->Clone("XiMassKinFit_Egamma_t181MC_waccsub");
	XiMassKinFit_Egamma_t181MC_waccsub->Add(XiMassKinFit_Egamma_t181MC_wacc,-0.5);
	TH1F * t181MC = (TH1F *)XiMassKinFit_Egamma_t181MC_waccsub->ProjectionY("t181MC",XiMassKinFit_Egamma_t181MC_waccsub->GetXaxis()->FindBin(1.31),XiMassKinFit_Egamma_t181MC_waccsub->GetXaxis()->FindBin(1.34));
 	TH2F * XiMassKinFit_Egamma_t188MC = (TH2F*)mc201808->Get("Xi_t");
	TH2F * XiMassKinFit_Egamma_t188MC_wacc = (TH2F*)mc201808->Get("Xi_t_wacc");
	TH2F * XiMassKinFit_Egamma_t188MC_waccsub = (TH2F *) XiMassKinFit_Egamma_t188MC->Clone("XiMassKinFit_Egamma_t188MC_waccsub");
	XiMassKinFit_Egamma_t188MC_waccsub->Add(XiMassKinFit_Egamma_t188MC_wacc,-0.5);
	TH1F * t188MC = (TH1F *)XiMassKinFit_Egamma_t188MC_waccsub->ProjectionY("t188MC",XiMassKinFit_Egamma_t188MC_waccsub->GetXaxis()->FindBin(1.31),XiMassKinFit_Egamma_t188MC_waccsub->GetXaxis()->FindBin(1.34));
	t171MC->RebinX(5);
	t181MC->RebinX(5);
	t188MC->RebinX(5);
	t171MC->Scale(norm201808/norm201701); 
	t181MC->Scale(norm201801/norm201801); 
	t188MC->Scale(norm201808/norm201808); 
	t171MC->SetLineColor(kGreen);
	t181MC->SetLineColor(kRed);
	t188MC->SetLineColor(kBlue);	
	t171MC->SetTitle("");
	t171MC->GetYaxis()->SetTitle("Combos");
	t171MC->Draw();
	t181MC->Draw("same");
	t188MC->Draw("same");
	legend_sets->Draw();
	sprintf(tdistMCname,"tdistMC.png");
	cctdistMC->Print(tdistMCname);


	TCanvas *ccXitdist_all = new TCanvas("ccXitdist_all", "ccXitdist_all", 800, 600);
	setformatTH1F(t171,color171,data);
	setformatTH1F(t181,color181,data);
	setformatTH1F(t188,color188,data);
	setformatTH1F(t171MC,color171,mc);
	setformatTH1F(t181MC,color181,mc);
	setformatTH1F(t188MC,color188,mc);
	normalizeMC(t171,t171MC);
	normalizeMC(t181,t181MC);
	normalizeMC(t188,t188MC);
	t188->SetTitle("");
	t188->GetXaxis()->SetTitle("-t (GeV^{2})");
	t188->Draw("pe");
	t171->Draw("pe,same");
	t171MC->Draw("pe,same");
	t181->Draw("pe,same");
	t181MC->Draw("pe,same");
	t188MC->Draw("pe,same");
	legend_all->Draw();
	ccXitdist_all->Print("t_allsets_june2020.png");

	char tdistname188[100];
	TCanvas *cct188dist = new TCanvas("cct188dist", "cct188dist", 800, 600);
 	TH2F * XiMassKinFit_Egamma_t188MC_Truth = (TH2F*)mc201808->Get("Xi_t_Truth");
	TH1F * t188MC_Truth = (TH1F *)XiMassKinFit_Egamma_t188MC_Truth->ProjectionY("t188MC_Truth",XiMassKinFit_Egamma_t188MC_Truth->GetXaxis()->FindBin(1.31),XiMassKinFit_Egamma_t188MC_Truth->GetXaxis()->FindBin(1.34));
	t188MC_Truth->RebinX(5);
	t188->SetLineColor(kGreen);
	t188MC->SetLineColor(kRed);
	t188MC_Truth->SetLineColor(kBlue);
	t188->SetTitle("");
	t188->GetYaxis()->SetTitle("Combos");
	double norm188data = t188->GetEntries();
	double norm188MC = t188MC->GetEntries();
	double norm188Truth = t188MC_Truth->GetEntries();
	t188->Scale(norm188data/norm188data); 
	t188MC->Scale(norm188data/norm188MC); 
	t188MC->Scale(norm188data/norm188Truth); 
	t188->Draw();
	t188MC->Draw("same");
	t188MC_Truth->Draw("same");
	auto legend_datamc = new TLegend(0.70,0.8,0.98,0.93);
	legend_datamc->AddEntry(t188,"Fall 2018 data","lep");
	legend_datamc->AddEntry(t188MC,"Fall 2018 mc","lep");
	legend_datamc->AddEntry(t188MC_Truth,"Fall 2018 Truth","lep");
	legend_datamc->Draw();
	sprintf(tdistname188,"tdist_%s.png",version201808);
	cct188dist->Print(tdistname188);


/*

	char KPxname[100];
	TH2I * KPx = (TH2I*)data201701->Get("kpkpxim__B4_M23/Hist_KinFitResults/Step0__Photon_Proton__K+_K+_Xi-/K+/Pull_Px_VsPhi");	
	TCanvas *ccPx = new TCanvas("ccPx", "ccPx", 800, 600);
	KPx->RebinX(5);
	KPx->RebinY(5);
        KPx->Draw("colz");
	sprintf(KPxname, "Kp_Px_%s.png",version);
	ccPx->Print(KPxname);

	char KPxnameM18[100];
	TH2I * KPxM18 = (TH2I*)data201701->Get("kpkpxim__B4_M18_M23/Hist_KinFitResults/Step0__Photon_Proton__K+_K+_Xi-/K+/Pull_Px_VsPhi");	
	TCanvas *ccPxM18 = new TCanvas("ccPxM18", "ccPxM18", 800, 600);
	KPxM18->RebinX(5);
	KPxM18->RebinY(5);
        KPxM18->Draw("colz");
	sprintf(KPxnameM18, "Kp_Px_M18_%s.png",version);
	ccPxM18->Print(KPxnameM18);

	char KPyname[100];
	TH2I * KPy = (TH2I*)data201701->Get("kpkpxim__B4_M23/Hist_KinFitResults/Step0__Photon_Proton__K+_K+_Xi-/K+/Pull_Py_VsPhi");	
	TCanvas *ccPy = new TCanvas("ccPy", "ccPy", 800, 600);
	KPy->RebinX(5);
	KPy->RebinY(5);
        KPy->Draw("colz");
	sprintf(KPyname, "Kp_Py_%s.png",version);
	ccPy->Print(KPyname);

	char KPynameM18[100];
	TH2I * KPyM18 = (TH2I*)data201701->Get("kpkpxim__B4_M18_M23/Hist_KinFitResults/Step0__Photon_Proton__K+_K+_Xi-/K+/Pull_Py_VsPhi");	
	TCanvas *ccPyM18 = new TCanvas("ccPyM18", "ccPyM18", 800, 600);
	KPyM18->RebinX(5);
	KPyM18->RebinY(5);
        KPyM18->Draw("colz");
	sprintf(KPynameM18, "Kp_Py_M18_%s.png",version);
	ccPyM18->Print(KPynameM18);

	char KPzname[100];
	TH2I * KPz = (TH2I*)data201701->Get("kpkpxim__B4_M23/Hist_KinFitResults/Step0__Photon_Proton__K+_K+_Xi-/K+/Pull_Pz_VsPhi");	
	TCanvas *ccPz = new TCanvas("ccPz", "ccPz", 800, 600);
	KPz->RebinX(5);
	KPz->RebinY(5);
        KPz->Draw("colz");
	sprintf(KPzname, "Kp_Pz_%s.png",version);
	ccPz->Print(KPzname);

	char KPznameM18[100];
	TH2I * KPzM18 = (TH2I*)data201701->Get("kpkpxim__B4_M18_M23/Hist_KinFitResults/Step0__Photon_Proton__K+_K+_Xi-/K+/Pull_Pz_VsPhi");	
	TCanvas *ccPzM18 = new TCanvas("ccPzM18", "ccPzM18", 800, 600);
	KPzM18->RebinX(5);
	KPzM18->RebinY(5);
        KPzM18->Draw("colz");
	sprintf(KPznameM18, "Kp_Pz_M18_%s.png",version);
	ccPzM18->Print(KPznameM18);

	char KXxname[100];
	TH2I * KXx = (TH2I*)data201701->Get("kpkpxim__B4_M23/Hist_KinFitResults/Step0__Photon_Proton__K+_K+_Xi-/K+/Pull_Xx_VsPhi");	
	TCanvas *ccXx = new TCanvas("ccXx", "ccXx", 800, 600);
	KXx->RebinX(5);
	KXx->RebinY(5);
        KXx->Draw("colz");
	sprintf(KXxname, "Kp_Xx_%s.png",version);
	ccXx->Print(KXxname);

	char KXxnameM18[100];
	TH2I * KXxM18 = (TH2I*)data201701->Get("kpkpxim__B4_M18_M23/Hist_KinFitResults/Step0__Photon_Proton__K+_K+_Xi-/K+/Pull_Xx_VsPhi");	
	TCanvas *ccXxM18 = new TCanvas("ccXxM18", "ccXxM18", 800, 600);
	KXxM18->RebinX(5);
	KXxM18->RebinY(5);
        KXxM18->Draw("colz");
	sprintf(KXxnameM18, "Kp_Xx_M18_%s.png",version);
	ccXxM18->Print(KXxnameM18);

	char KXyname[100];
	TH2I * KXy = (TH2I*)data201701->Get("kpkpxim__B4_M23/Hist_KinFitResults/Step0__Photon_Proton__K+_K+_Xi-/K+/Pull_Xy_VsPhi");	
	TCanvas *ccXy = new TCanvas("ccXy", "ccXy", 800, 600);
	KXy->RebinX(5);
	KXy->RebinY(5);
        KXy->Draw("colz");
	sprintf(KXyname, "Kp_Xy_%s.png",version);
	ccXy->Print(KXyname);

	char KXynameM18[100];
	TH2I * KXyM18 = (TH2I*)data201701->Get("kpkpxim__B4_M18_M23/Hist_KinFitResults/Step0__Photon_Proton__K+_K+_Xi-/K+/Pull_Xy_VsPhi");	
	TCanvas *ccXyM18 = new TCanvas("ccXyM18", "ccXyM18", 800, 600);
	KXyM18->RebinX(5);
	KXyM18->RebinY(5);
        KXyM18->Draw("colz");
	sprintf(KXynameM18, "Kp_Xy_M18_%s.png",version);
	ccXyM18->Print(KXynameM18);


	char KXzname[100];
	TH2I * KXz = (TH2I*)data201701->Get("kpkpxim__B4_M23/Hist_KinFitResults/Step0__Photon_Proton__K+_K+_Xi-/K+/Pull_Xz_VsPhi");	
	TCanvas *ccXz = new TCanvas("ccXz", "ccXz", 800, 600);
	KXz->RebinX(5);
	KXz->RebinY(5);
        KXz->Draw("colz");
	sprintf(KXzname, "Kp_Xz_%s.png",version);
	ccXz->Print(KXzname);

	char KXznameM18[100];
	TH2I * KXzM18 = (TH2I*)data201701->Get("kpkpxim__B4_M18_M23/Hist_KinFitResults/Step0__Photon_Proton__K+_K+_Xi-/K+/Pull_Xz_VsPhi");	
	TCanvas *ccXzM18 = new TCanvas("ccXzM18", "ccXzM18", 800, 600);
	KXzM18->RebinX(5);
	KXzM18->RebinY(5);
        KXzM18->Draw("colz");
	sprintf(KXznameM18, "Kp_Xz_M18_%s.png",version);
	ccXzM18->Print(KXznameM18);

	char pixiPxname[100];
	TH2I * pixiPx = (TH2I*)data201701->Get("kpkpxim__B4_M23/Hist_KinFitResults/Step1__Xi-__Pi-_Lambda/Pi-/Pull_Px_VsPhi");	
	TCanvas *ccpixiPx = new TCanvas("ccpixiPx", "ccpixiPx", 800, 600);
	pixiPx->RebinX(5);
	pixiPx->RebinY(5);
        pixiPx->Draw("colz");
	sprintf(pixiPxname, "PimXi_Px_%s.png",version);
	ccpixiPx->Print(pixiPxname);

	char pixiPxnameM18[100];
	TH2I * pixiPxM18 = (TH2I*)data201701->Get("kpkpxim__B4_M18_M23/Hist_KinFitResults/Step1__Xi-__Pi-_Lambda/Pi-/Pull_Px_VsPhi");	
	TCanvas *ccpixiPxM18 = new TCanvas("ccpixiPxM18", "ccpixiPxM18", 800, 600);
	pixiPxM18->RebinX(5);
	pixiPxM18->RebinY(5);
        pixiPxM18->Draw("colz");
	sprintf(pixiPxnameM18, "PimXi_Px_M18_%s.png",version);
	ccpixiPxM18->Print(pixiPxnameM18);

	char pixiPyname[100];
	TH2I * pixiPy = (TH2I*)data201701->Get("kpkpxim__B4_M23/Hist_KinFitResults/Step1__Xi-__Pi-_Lambda/Pi-/Pull_Py_VsPhi");	
	TCanvas *ccpixiPy = new TCanvas("ccpixiPy", "ccpixiPy", 800, 600);
	pixiPy->RebinX(5);
	pixiPy->RebinY(5);
        pixiPy->Draw("colz");
	sprintf(pixiPyname, "PimXi_Py_%s.png",version);
	ccpixiPy->Print(pixiPyname);

	char pixiPynameM18[100];
	TH2I * pixiPyM18 = (TH2I*)data201701->Get("kpkpxim__B4_M18_M23/Hist_KinFitResults/Step1__Xi-__Pi-_Lambda/Pi-/Pull_Py_VsPhi");	
	TCanvas *ccpixiPyM18 = new TCanvas("ccpixiPyM18", "ccpixiPyM18", 800, 600);
	pixiPyM18->RebinX(5);
	pixiPyM18->RebinY(5);
        pixiPyM18->Draw("colz");
	sprintf(pixiPynameM18, "PimXi_Py_M18_%s.png",version);
	ccpixiPyM18->Print(pixiPynameM18);

	char pixiPzname[100];
	TH2I * pixiPz = (TH2I*)data201701->Get("kpkpxim__B4_M23/Hist_KinFitResults/Step1__Xi-__Pi-_Lambda/Pi-/Pull_Pz_VsPhi");	
	TCanvas *ccpixiPz = new TCanvas("ccpixiPz", "ccpixiPz", 800, 600);
	pixiPz->RebinX(5);
	pixiPz->RebinY(5);
        pixiPz->Draw("colz");
	sprintf(pixiPzname, "PimXi_Pz_%s.png",version);
	ccpixiPz->Print(pixiPzname);

	char pixiPznameM18[100];
	TH2I * pixiPzM18 = (TH2I*)data201701->Get("kpkpxim__B4_M18_M23/Hist_KinFitResults/Step1__Xi-__Pi-_Lambda/Pi-/Pull_Pz_VsPhi");	
	TCanvas *ccpixiPzM18 = new TCanvas("ccpixiPzM18", "ccpixiPzM18", 800, 600);
	pixiPzM18->RebinX(5);
	pixiPzM18->RebinY(5);
        pixiPzM18->Draw("colz");
	sprintf(pixiPznameM18, "PimXi_Pz_M18_%s.png",version);
	ccpixiPzM18->Print(pixiPznameM18);

	char pixiXxname[100];
	TH2I * pixiXx = (TH2I*)data201701->Get("kpkpxim__B4_M23/Hist_KinFitResults/Step1__Xi-__Pi-_Lambda/Pi-/Pull_Xx_VsPhi");	
	TCanvas *ccpixiXx = new TCanvas("ccpixiXx", "ccpixiXx", 800, 600);
	pixiXx->RebinX(5);
	pixiXx->RebinY(5);
        pixiXx->Draw("colz");
	sprintf(pixiXxname, "PimXi_Xx_%s.png",version);
	ccpixiXx->Print(pixiXxname);

	char pixiXxnameM18[100];
	TH2I * pixiXxM18 = (TH2I*)data201701->Get("kpkpxim__B4_M18_M23/Hist_KinFitResults/Step1__Xi-__Pi-_Lambda/Pi-/Pull_Xx_VsPhi");	
	TCanvas *ccpixiXxM18 = new TCanvas("ccpixiXxM18", "ccpixiXxM18", 800, 600);
	pixiXxM18->RebinX(5);
	pixiXxM18->RebinY(5);
        pixiXxM18->Draw("colz");
	sprintf(pixiXxnameM18, "PimXi_Xx_M18_%s.png",version);
	ccpixiXxM18->Print(pixiXxnameM18);

	char pixiXyname[100];
	TH2I * pixiXy = (TH2I*)data201701->Get("kpkpxim__B4_M23/Hist_KinFitResults/Step1__Xi-__Pi-_Lambda/Pi-/Pull_Xy_VsPhi");	
	TCanvas *ccpixiXy = new TCanvas("ccpixiXy", "ccpixiXy", 800, 600);
	pixiXy->RebinX(5);
	pixiXy->RebinY(5);
        pixiXy->Draw("colz");
	sprintf(pixiXyname, "PimXi_Xy_%s.png",version);
	ccpixiXy->Print(pixiXyname);

	char pixiXynameM18[100];
	TH2I * pixiXyM18 = (TH2I*)data201701->Get("kpkpxim__B4_M18_M23/Hist_KinFitResults/Step1__Xi-__Pi-_Lambda/Pi-/Pull_Xy_VsPhi");	
	TCanvas *ccpixiXyM18 = new TCanvas("ccpixiXyM18", "ccpixiXyM18", 800, 600);
	pixiXyM18->RebinX(5);
	pixiXyM18->RebinY(5);
        pixiXyM18->Draw("colz");
	sprintf(pixiXynameM18, "PimXi_Xy_M18_%s.png",version);
	ccpixiXyM18->Print(pixiXynameM18);


	char pixiXzname[100];
	TH2I * pixiXz = (TH2I*)data201701->Get("kpkpxim__B4_M23/Hist_KinFitResults/Step1__Xi-__Pi-_Lambda/Pi-/Pull_Xz_VsPhi");	
	TCanvas *ccpixiXz = new TCanvas("ccpixiXz", "ccpixiXz", 800, 600);
	pixiXz->RebinX(5);
	pixiXz->RebinY(5);
        pixiXz->Draw("colz");
	sprintf(pixiXzname, "PimXi_Xz_%s.png",version);
	ccpixiXz->Print(pixiXzname);

	char pixiXznameM18[100];
	TH2I * pixiXzM18 = (TH2I*)data201701->Get("kpkpxim__B4_M18_M23/Hist_KinFitResults/Step1__Xi-__Pi-_Lambda/Pi-/Pull_Xz_VsPhi");	
	TCanvas *ccpixiXzM18 = new TCanvas("ccpixiXzM18", "ccpixiXzM18", 800, 600);
	pixiXzM18->RebinX(5);
	pixiXzM18->RebinY(5);
        pixiXzM18->Draw("colz");
	sprintf(pixiXznameM18, "PimXi_Xz_M18_%s.png",version);
	ccpixiXzM18->Print(pixiXznameM18);

	char pilambPxname[100];
	TH2I * pilambPx = (TH2I*)data201701->Get("kpkpxim__B4_M23/Hist_KinFitResults/Step2__Lambda__Pi-_Proton/Pi-/Pull_Px_VsPhi");	
	TCanvas *ccpilambPx = new TCanvas("ccpilambPx", "ccpilambPx", 800, 600);
	pilambPx->RebinX(5);
	pilambPx->RebinY(5);
        pilambPx->Draw("colz");
	sprintf(pilambPxname, "PimLamb_Px_%s.png",version);
	ccpilambPx->Print(pilambPxname);

	char pilambPxnameM18[100];
	TH2I * pilambPxM18 = (TH2I*)data201701->Get("kpkpxim__B4_M18_M23/Hist_KinFitResults/Step2__Lambda__Pi-_Proton/Pi-/Pull_Px_VsPhi");	
	TCanvas *ccpilambPxM18 = new TCanvas("ccpilambPxM18", "ccpilambPxM18", 800, 600);
	pilambPxM18->RebinX(5);
	pilambPxM18->RebinY(5);
        pilambPxM18->Draw("colz");
	sprintf(pilambPxnameM18, "PimLamb_Px_M18_%s.png",version);
	ccpilambPxM18->Print(pilambPxnameM18);

	char pilambPyname[100];
	TH2I * pilambPy = (TH2I*)data201701->Get("kpkpxim__B4_M23/Hist_KinFitResults/Step2__Lambda__Pi-_Proton/Pi-/Pull_Py_VsPhi");	
	TCanvas *ccpilambPy = new TCanvas("ccpilambPy", "ccpilambPy", 800, 600);
	pilambPy->RebinX(5);
	pilambPy->RebinY(5);
        pilambPy->Draw("colz");
	sprintf(pilambPyname, "PimLamb_Py_%s.png",version);
	ccpilambPy->Print(pilambPyname);

	char pilambPynameM18[100];
	TH2I * pilambPyM18 = (TH2I*)data201701->Get("kpkpxim__B4_M18_M23/Hist_KinFitResults/Step2__Lambda__Pi-_Proton/Pi-/Pull_Py_VsPhi");	
	TCanvas *ccpilambPyM18 = new TCanvas("ccpilambPyM18", "ccpilambPyM18", 800, 600);
	pilambPyM18->RebinX(5);
	pilambPyM18->RebinY(5);
        pilambPyM18->Draw("colz");
	sprintf(pilambPynameM18, "PimLamb_Py_M18_%s.png",version);
	ccpilambPyM18->Print(pilambPynameM18);

	char pilambPzname[100];
	TH2I * pilambPz = (TH2I*)data201701->Get("kpkpxim__B4_M23/Hist_KinFitResults/Step2__Lambda__Pi-_Proton/Pi-/Pull_Pz_VsPhi");	
	TCanvas *ccpilambPz = new TCanvas("ccpilambPz", "ccpilambPz", 800, 600);
	pilambPz->RebinX(5);
	pilambPz->RebinY(5);
        pilambPz->Draw("colz");
	sprintf(pilambPzname, "PimLamb_Pz_%s.png",version);
	ccpilambPz->Print(pilambPzname);

	char pilambPznameM18[100];
	TH2I * pilambPzM18 = (TH2I*)data201701->Get("kpkpxim__B4_M18_M23/Hist_KinFitResults/Step2__Lambda__Pi-_Proton/Pi-/Pull_Pz_VsPhi");	
	TCanvas *ccpilambPzM18 = new TCanvas("ccpilambPzM18", "ccpilambPzM18", 800, 600);
	pilambPzM18->RebinX(5);
	pilambPzM18->RebinY(5);
        pilambPzM18->Draw("colz");
	sprintf(pilambPznameM18, "PimLamb_Pz_M18_%s.png",version);
	ccpilambPzM18->Print(pilambPznameM18);

	char pilambXxname[100];
	TH2I * pilambXx = (TH2I*)data201701->Get("kpkpxim__B4_M23/Hist_KinFitResults/Step2__Lambda__Pi-_Proton/Pi-/Pull_Xx_VsPhi");	
	TCanvas *ccpilambXx = new TCanvas("ccpilambXx", "ccpilambXx", 800, 600);
	pilambXx->RebinX(5);
	pilambXx->RebinY(5);
        pilambXx->Draw("colz");
	sprintf(pilambXxname, "PimLamb_Xx_%s.png",version);
	ccpilambXx->Print(pilambXxname);

	char pilambXxnameM18[100];
	TH2I * pilambXxM18 = (TH2I*)data201701->Get("kpkpxim__B4_M18_M23/Hist_KinFitResults/Step2__Lambda__Pi-_Proton/Pi-/Pull_Xx_VsPhi");	
	TCanvas *ccpilambXxM18 = new TCanvas("ccpilambXxM18", "ccpilambXxM18", 800, 600);
	pilambXxM18->RebinX(5);
	pilambXxM18->RebinY(5);
        pilambXxM18->Draw("colz");
	sprintf(pilambXxnameM18, "PimLamb_Xx_M18_%s.png",version);
	ccpilambXxM18->Print(pilambXxnameM18);

	char pilambXyname[100];
	TH2I * pilambXy = (TH2I*)data201701->Get("kpkpxim__B4_M23/Hist_KinFitResults/Step2__Lambda__Pi-_Proton/Pi-/Pull_Xy_VsPhi");	
	TCanvas *ccpilambXy = new TCanvas("ccpilambXy", "ccpilambXy", 800, 600);
	pilambXy->RebinX(5);
	pilambXy->RebinY(5);
        pilambXy->Draw("colz");
	sprintf(pilambXyname, "PimLamb_Xy_%s.png",version);
	ccpilambXy->Print(pilambXyname);

	char pilambXynameM18[100];
	TH2I * pilambXyM18 = (TH2I*)data201701->Get("kpkpxim__B4_M18_M23/Hist_KinFitResults/Step2__Lambda__Pi-_Proton/Pi-/Pull_Xy_VsPhi");	
	TCanvas *ccpilambXyM18 = new TCanvas("ccpilambXyM18", "ccpilambXyM18", 800, 600);
	pilambXyM18->RebinX(5);
	pilambXyM18->RebinY(5);
        pilambXyM18->Draw("colz");
	sprintf(pilambXynameM18, "PimLamb_Xy_M18_%s.png",version);
	ccpilambXyM18->Print(pilambXynameM18);


	char pilambXzname[100];
	TH2I * pilambXz = (TH2I*)data201701->Get("kpkpxim__B4_M23/Hist_KinFitResults/Step2__Lambda__Pi-_Proton/Pi-/Pull_Xz_VsPhi");	
	TCanvas *ccpilambXz = new TCanvas("ccpilambXz", "ccpilambXz", 800, 600);
	pilambXz->RebinX(5);
	pilambXz->RebinY(5);
        pilambXz->Draw("colz");
	sprintf(pilambXzname, "PimLamb_Xz_%s.png",version);
	ccpilambXz->Print(pilambXzname);

	char pilambXznameM18[100];
	TH2I * pilambXzM18 = (TH2I*)data201701->Get("kpkpxim__B4_M18_M23/Hist_KinFitResults/Step2__Lambda__Pi-_Proton/Pi-/Pull_Xz_VsPhi");	
	TCanvas *ccpilambXzM18 = new TCanvas("ccpilambXzM18", "ccpilambXzM18", 800, 600);
	pilambXzM18->RebinX(5);
	pilambXzM18->RebinY(5);
        pilambXzM18->Draw("colz");
	sprintf(pilambXznameM18, "PimLamb_Xz_M18_%s.png",version);
	ccpilambXzM18->Print(pilambXznameM18);

	char protPxname[100];
	TH2I * protPx = (TH2I*)data201701->Get("kpkpxim__B4_M23/Hist_KinFitResults/Step2__Lambda__Pi-_Proton/Proton/Pull_Px_VsPhi");	
	TCanvas *ccprotPx = new TCanvas("ccprotPx", "ccprotPx", 800, 600);
	protPx->RebinX(5);
	protPx->RebinY(5);
        protPx->Draw("colz");
	sprintf(protPxname, "P_Px_%s.png",version);
	ccprotPx->Print(protPxname);

	char protPxnameM18[100];
	TH2I * protPxM18 = (TH2I*)data201701->Get("kpkpxim__B4_M18_M23/Hist_KinFitResults/Step2__Lambda__Pi-_Proton/Proton/Pull_Px_VsPhi");	
	TCanvas *ccprotPxM18 = new TCanvas("ccprotPxM18", "ccprotPxM18", 800, 600);
	protPxM18->RebinX(5);
	protPxM18->RebinY(5);
        protPxM18->Draw("colz");
	sprintf(protPxnameM18, "P_Px_M18_%s.png",version);
	ccprotPxM18->Print(protPxnameM18);

	char protPyname[100];
	TH2I * protPy = (TH2I*)data201701->Get("kpkpxim__B4_M23/Hist_KinFitResults/Step2__Lambda__Pi-_Proton/Proton/Pull_Py_VsPhi");	
	TCanvas *ccprotPy = new TCanvas("ccprotPy", "ccprotPy", 800, 600);
	protPy->RebinX(5);
	protPy->RebinY(5);
        protPy->Draw("colz");
	sprintf(protPyname, "P_Py_%s.png",version);
	ccprotPy->Print(protPyname);

	char protPynameM18[100];
	TH2I * protPyM18 = (TH2I*)data201701->Get("kpkpxim__B4_M18_M23/Hist_KinFitResults/Step2__Lambda__Pi-_Proton/Proton/Pull_Py_VsPhi");	
	TCanvas *ccprotPyM18 = new TCanvas("ccprotPyM18", "ccprotPyM18", 800, 600);
	protPyM18->RebinX(5);
	protPyM18->RebinY(5);
        protPyM18->Draw("colz");
	sprintf(protPynameM18, "P_Py_M18_%s.png",version);
	ccprotPyM18->Print(protPynameM18);

	char protPzname[100];
	TH2I * protPz = (TH2I*)data201701->Get("kpkpxim__B4_M23/Hist_KinFitResults/Step2__Lambda__Pi-_Proton/Proton/Pull_Pz_VsPhi");	
	TCanvas *ccprotPz = new TCanvas("ccprotPz", "ccprotPz", 800, 600);
	protPz->RebinX(5);
	protPz->RebinY(5);
        protPz->Draw("colz");
	sprintf(protPzname, "P_Pz_%s.png",version);
	ccprotPz->Print(protPzname);

	char protPznameM18[100];
	TH2I * protPzM18 = (TH2I*)data201701->Get("kpkpxim__B4_M18_M23/Hist_KinFitResults/Step2__Lambda__Pi-_Proton/Proton/Pull_Pz_VsPhi");	
	TCanvas *ccprotPzM18 = new TCanvas("ccprotPzM18", "ccprotPzM18", 800, 600);
	protPzM18->RebinX(5);
	protPzM18->RebinY(5);
        protPzM18->Draw("colz");
	sprintf(protPznameM18, "P_Pz_M18_%s.png",version);
	ccprotPzM18->Print(protPznameM18);

	char protXxname[100];
	TH2I * protXx = (TH2I*)data201701->Get("kpkpxim__B4_M23/Hist_KinFitResults/Step2__Lambda__Pi-_Proton/Proton/Pull_Xx_VsPhi");	
	TCanvas *ccprotXx = new TCanvas("ccprotXx", "ccprotXx", 800, 600);
	protXx->RebinX(5);
	protXx->RebinY(5);
        protXx->Draw("colz");
	sprintf(protXxname, "P_Xx_%s.png",version);
	ccprotXx->Print(protXxname);

	char protXxnameM18[100];
	TH2I * protXxM18 = (TH2I*)data201701->Get("kpkpxim__B4_M18_M23/Hist_KinFitResults/Step2__Lambda__Pi-_Proton/Proton/Pull_Xx_VsPhi");	
	TCanvas *ccprotXxM18 = new TCanvas("ccprotXxM18", "ccprotXxM18", 800, 600);
	protXxM18->RebinX(5);
	protXxM18->RebinY(5);
        protXxM18->Draw("colz");
	sprintf(protXxnameM18, "P_Xx_M18_%s.png",version);
	ccprotXxM18->Print(protXxnameM18);

	char protXyname[100];
	TH2I * protXy = (TH2I*)data201701->Get("kpkpxim__B4_M23/Hist_KinFitResults/Step2__Lambda__Pi-_Proton/Proton/Pull_Xy_VsPhi");	
	TCanvas *ccprotXy = new TCanvas("ccprotXy", "ccprotXy", 800, 600);
	protXy->RebinX(5);
	protXy->RebinY(5);
        protXy->Draw("colz");
	sprintf(protXyname, "P_Xy_%s.png",version);
	ccprotXy->Print(protXyname);

	char protXynameM18[100];
	TH2I * protXyM18 = (TH2I*)data201701->Get("kpkpxim__B4_M18_M23/Hist_KinFitResults/Step2__Lambda__Pi-_Proton/Proton/Pull_Xy_VsPhi");	
	TCanvas *ccprotXyM18 = new TCanvas("ccprotXyM18", "ccprotXyM18", 800, 600);
	protXyM18->RebinX(5);
	protXyM18->RebinY(5);
        protXyM18->Draw("colz");
	sprintf(protXynameM18, "P_Xy_M18_%s.png",version);
	ccprotXyM18->Print(protXynameM18);


	char protXzname[100];
	TH2I * protXz = (TH2I*)data201701->Get("kpkpxim__B4_M23/Hist_KinFitResults/Step2__Lambda__Pi-_Proton/Proton/Pull_Xz_VsPhi");	
	TCanvas *ccprotXz = new TCanvas("ccprotXz", "ccprotXz", 800, 600);
	protXz->RebinX(5);
	protXz->RebinY(5);
        protXz->Draw("colz");
	sprintf(protXzname, "P_Xz_%s.png",version);
	ccprotXz->Print(protXzname);

	char protXznameM18[100];
	TH2I * protXzM18 = (TH2I*)data201701->Get("kpkpxim__B4_M18_M23/Hist_KinFitResults/Step2__Lambda__Pi-_Proton/Proton/Pull_Xz_VsPhi");	
	TCanvas *ccprotXzM18 = new TCanvas("ccprotXzM18", "ccprotXzM18", 800, 600);
	protXzM18->RebinX(5);
	protXzM18->RebinY(5);
        protXzM18->Draw("colz");
	sprintf(protXznameM18, "P_Xz_M18_%s.png",version);
	ccprotXzM18->Print(protXznameM18);

*/
	outputfile->Write();
	return;	
	
}
